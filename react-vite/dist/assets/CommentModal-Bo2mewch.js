import{r as e}from"./react-vendor-DWDxyCYt.js";import{c as t,s,C as r}from"./CommentThread-8lV8dGCX.js";import{a,u as n,L as l}from"./router-vendor-DqRelNZw.js";import{j as o}from"./index-fkdTXUqh.js";import{a as i}from"./redux-vendor-s9F9CGgp.js";import{e as c,X as d,a0 as m,a8 as u,c as p,a7 as h,w as f,a9 as x,a5 as g,V as b}from"./ui-vendor-LOG_mfyu.js";const j=(s={})=>{const{initialComments:r=[],forceRefreshOnClose:l=!1,redirectOnClose:o,refreshDelay:i=100}=s,c=a(),d=n(),[m,u]=e.useState({isOpen:!1,postId:null,comments:r,isLoading:!1,error:null,page:1,hasMore:!0}),[p,h]=e.useState(r),[f,x]=e.useState(!1),[g,b]=e.useState(null),j=e.useRef(!1),v=e.useRef(null),y=e.useRef(null),N=e.useRef(0),w=e.useRef(!1),k=e.useCallback(()=>{if(l)return!0;if(!w.current)return!1;const e=c.pathname;return["/posts-feed","/similar-feed","/profile","/profile-feed"].some(t=>e.startsWith(t))||e.match(/^\/posts\/\d+$/)},[l,c.pathname]),C=e.useCallback(()=>{setTimeout(()=>{o?d(o):window.location.reload()},i)},[d,o,i]),I=e.useCallback(()=>{b(null),u(e=>({...e,error:null}))},[]),E=e.useCallback(e=>e.reduce((e,t)=>{let s=1;return t.replies&&t.replies.length>0&&(s+=E(t.replies)),e+s},0),[]);e.useEffect(()=>{if(m.isOpen&&m.postId&&y.current){const e=E(m.comments);e!==N.current&&(w.current=!0,y.current(m.postId,e))}},[m.comments,m.isOpen,m.postId,E]);const S=e.useCallback(async(e,s=1)=>{if(j.current)return[];j.current=!0,x(!0),I();try{const r=await t.getPostComments(e,{page:s,perPage:20,includeReplies:!0,includeLikes:!1}),a=r.comments||[];return 1===s?(h(a),u(e=>{var t;return{...e,comments:a,page:2,hasMore:(null==(t=r.pagination)?void 0:t.hasNext)||!1}})):(h(e=>[...e,...a]),u(e=>{var t;return{...e,comments:[...e.comments,...a],page:s+1,hasMore:(null==(t=r.pagination)?void 0:t.hasNext)||!1}})),v.current=e,a}catch(r){const e=r instanceof Error?r.message:"Failed to load comments";throw b(e),u(t=>({...t,error:e})),r}finally{x(!1),j.current=!1,u(e=>({...e,isLoading:!1}))}},[I]),L=e.useCallback(async()=>{v.current&&await S(v.current,1)},[S]),T=e.useCallback((e,t,s)=>{const r=t||[],a=E(r);N.current=a,y.current=s||null,w.current=!1,u(t=>({...t,isOpen:!0,postId:e,comments:r,page:1,hasMore:!0,error:null})),r.length>0&&h(r),t&&0!==t.length||S(e,1)},[S,E]),A=e.useCallback(()=>{if(m.isOpen&&m.postId&&y.current&&w.current){const e=E(m.comments);y.current(m.postId,e)}u(e=>({...e,isOpen:!1,postId:null,error:null})),k()&&C(),y.current=null,N.current=0,w.current=!1},[m.isOpen,m.postId,m.comments,E,k,C]),O=e.useCallback(async e=>{try{const s=(e.parentId?await t.createReply(e):await t.createComment(e)).comment;return w.current=!0,h(e=>[s,...e]),u(e=>({...e,comments:[s,...e.comments]})),s}catch(s){const e=s instanceof Error?s.message:"Failed to add comment";throw b(e),s}},[]),R=e.useCallback(async(e,s)=>{try{await t.updateComment(e,s),w.current=!0;const r=t=>t.map(t=>t.id===e?{...t,comment:s,updatedAt:(new Date).toISOString()}:t.replies?{...t,replies:r(t.replies)}:t);h(e=>r(e)),u(e=>({...e,comments:r(e.comments)}))}catch(r){const e=r instanceof Error?r.message:"Failed to edit comment";throw b(e),r}},[]),z=e.useCallback(async e=>{if(!m.postId)throw new Error("No post ID available");try{await t.deleteComment(m.postId,e),w.current=!0;const s=t=>t.filter(t=>t.id!==e&&(t.replies&&(t.replies=s(t.replies)),!0));h(e=>s(e)),u(e=>({...e,comments:s(e.comments)}))}catch(s){const e=s instanceof Error?s.message:"Failed to delete comment";throw b(e),s}},[m.postId]),D=e.useCallback(()=>E(p),[p,E]),M=e.useCallback(e=>{const t=s=>{for(const r of s){if(r.id===e)return r;if(r.replies){const e=t(r.replies);if(e)return e}}};return t(p)},[p]);return{modal:m,comments:p,isLoading:f,error:g,openModal:T,closeModal:A,addComment:O,editComment:R,deleteComment:z,loadComments:S,refreshComments:L,getCommentCount:D,getCommentById:M,clearError:I,forceRefresh:C,hasChanges:w.current}},v=({isOpen:t,onClose:s,commentId:r})=>{const[a,n]=e.useState([]),[i,h]=e.useState(!1),[f,x]=e.useState(null),[g,b]=e.useState(""),j=e.useCallback(async()=>{h(!0),x(null);try{const e=await fetch(`/api/comments/${r}/likes`,{credentials:"include"});if(!e.ok)throw new Error("Failed to fetch comment likes");const t=await e.json();n(t.likes||[]),b(t.comment||"")}catch(e){x("Failed to load likes. Please try again.")}finally{h(!1)}},[r]),v=e.useCallback(async()=>{try{const e=await fetch(`/api/comments/${r}`,{credentials:"include"});if(e.ok){const t=await e.json();b(t.comment||"")}}catch(e){}},[r]);e.useEffect(()=>{t&&r&&(j(),v())},[t,r,j,v]);return e.useEffect(()=>{const e=e=>{"Escape"===e.key&&s()};return t&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[t,s]),t?o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:e=>{e.target===e.currentTarget&&s()},children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-slate-200 w-full max-w-md max-h-[70vh] flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:o.jsx(c,{size:20,className:"text-red-500"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Comment Likes"}),o.jsx("p",{className:"text-sm text-slate-600",children:i?"Loading...":`${a.length} ${1===a.length?"person":"people"} liked this comment`})]})]}),o.jsx("button",{onClick:s,className:"p-2 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100 transition-colors",children:o.jsx(d,{size:20})})]}),g&&o.jsx("div",{className:"p-4 border-b border-slate-100 bg-slate-50",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(m,{size:16,className:"text-slate-400 mt-0.5 flex-shrink-0"}),o.jsx("p",{className:"text-sm text-slate-700 line-clamp-2",children:g.length>100?`${g.slice(0,100)}...`:g})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:i?o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx(u,{size:24,className:"animate-spin text-red-500"})}):f?o.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-6 text-center",children:[o.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:o.jsx(c,{size:24,className:"text-red-500"})}),o.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Oops! Something went wrong"}),o.jsx("p",{className:"text-slate-600 mb-4",children:f}),o.jsx("button",{onClick:j,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"Try Again"})]}):0===a.length?o.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-6 text-center",children:[o.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4",children:o.jsx(p,{size:24,className:"text-slate-400"})}),o.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No likes yet"}),o.jsx("p",{className:"text-slate-600",children:"Be the first to show some love for this comment!"})]}):o.jsx("div",{className:"px-6 py-4",children:o.jsx("div",{className:"space-y-3",children:a.map(e=>o.jsxs(l,{to:`/users/${e.id}`,onClick:s,className:"flex items-center gap-3 p-3 rounded-lg hover:bg-slate-50 transition-colors group",children:[o.jsx("img",{src:e.profileImage,alt:e.username,className:"w-10 h-10 rounded-full object-cover border-2 border-slate-200 group-hover:border-red-500 transition-colors",onError:e=>{e.target.src="/default-avatar.png"}}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium text-slate-900 group-hover:text-red-600 transition-colors truncate",children:e.username}),o.jsxs("div",{className:"text-sm text-slate-600 truncate",children:[e.firstName," ",e.lastName]})]}),o.jsx("div",{className:"text-red-500 opacity-60 group-hover:opacity-100 transition-opacity",children:o.jsx(c,{size:14,fill:"currentColor"})})]},e.id))})})}),a.length>0&&!i&&o.jsx("div",{className:"p-4 border-t border-slate-200 bg-slate-50",children:o.jsx("div",{className:"text-center",children:o.jsx("p",{className:"text-sm text-slate-600",children:1===a.length?"1 person likes this comment":`${a.length} people like this comment`})})})]})}):null},y=({isOpen:c,onClose:j,postId:y,initialComments:N=[],onCommentChange:w,forceRefreshOnClose:k=!1,redirectOnClose:C})=>{const I=i(e=>e.session.user),E=e.useRef(null),S=a(),L=n(),T=e.useRef(0),A=e.useRef(0),O=e.useRef(!1),[R,z]=e.useState([]),[D,M]=e.useState(!1),[$,F]=e.useState(!1),[_,U]=e.useState(null),[P,B]=e.useState(""),[W,G]=e.useState("newest"),[H,V]=e.useState(!1),[q,J]=e.useState(""),[K,Q]=e.useState(null),[X,Y]=e.useState(""),[Z,ee]=e.useState({}),[te,se]=e.useState({isOpen:!1,commentId:null}),[re,ae]=e.useState(new Map),ne=e.useCallback(()=>{if(k)return!0;if(O.current){const e=S.pathname;return["/posts-feed","/similar-feed","/profile","/profile-feed"].some(t=>e.startsWith(t))||e.match(/^\/posts\/\d+$/)}return!1},[k,S.pathname]),le=e.useCallback((e,t)=>{O.current=!0,A.current=t,w&&w(e,t)},[w]);e.useEffect(()=>{if(c&&R.length>=0){const e=R.length;0===T.current&&(T.current=e),A.current=e}},[c,R.length]);const oe=e.useCallback(()=>{if(O.current&&w){const e=A.current;w(e>T.current?"add":"delete",e)}B(""),U(null),z([]),J(""),Q(null),Y(""),ee({}),V(!1),se({isOpen:!1,commentId:null}),j(),setTimeout(()=>{C?L(C):ne()&&window.location.reload()},100)},[j,w,ne,L,C]);e.useEffect(()=>{if(R&&R.length>0){const e=new Map;(t=>{t.forEach(t=>{e.set(t.id,{isLiked:t.isLiked||!1,likeCount:t.likes||0})})})(R),ae(e)}},[R]);const ie=e.useCallback(e=>{const t=[],s=e=>{var r;const a={id:e.id,userId:e.userId,postId:e.postId,comment:e.comment,username:(null==(r=e.commenter)?void 0:r.username)||"Unknown User",parentId:e.parentId,created_at:e.createdAt,updated_at:e.updatedAt,commenter:e.commenter,likes:e.likes||0,isLiked:e.isLiked||!1};t.push(a),e.replies&&e.replies.length>0&&e.replies.forEach(s)};return e.forEach(s),t},[]),ce=e.useCallback(e=>{if(!e||0===e.length)return[];const t=new Map,s=[];return e.forEach(e=>{let s;s=e.commenter?{id:e.commenter.id,username:e.commenter.username,firstName:e.commenter.firstName||"",lastName:e.commenter.lastName||"",profileImage:e.commenter.profileImage||"/default-avatar.png"}:I&&e.userId===I.id?{id:I.id,username:I.username,firstName:I.firstName||"",lastName:I.lastName||"",profileImage:I.profileImage||"/default-avatar.png"}:{id:e.userId,username:e.username||"Unknown User",firstName:"",lastName:"",profileImage:"/default-avatar.png"};const r=re.get(e.id),a=(null==r?void 0:r.likeCount)??e.likes??0,n=(null==r?void 0:r.isLiked)??e.isLiked??!1,l={id:e.id,userId:e.userId,postId:e.postId,comment:e.comment,parentId:e.parentId,createdAt:e.created_at,updatedAt:e.updated_at,commenter:s,replies:[],likes:a,isLiked:n};t.set(e.id,l)}),e.forEach(e=>{const r=t.get(e.id);if(null===e.parentId||void 0===e.parentId)s.push(r),r.replies=[];else{const a=t.get(e.parentId);a?(a.replies||(a.replies=[]),a.replies.push(r)):s.push(r)}}),s.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()),s.forEach(e=>{e.replies&&e.replies.length>0&&e.replies.sort((e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime())}),s},[I,re]),de=e.useMemo(()=>{if(R&&R.length>0){return ce(R)}return[]},[R,ce]),me=e.useMemo(()=>{let e=[...de];return P.trim()&&(e=s(e,P)),e.sort((e,t)=>{var s,r;switch(W){case"oldest":return new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime();case"popular":{const a=e.likes||0,n=t.likes||0;if(a!==n)return n-a;const l=(null==(s=e.replies)?void 0:s.length)||0,o=(null==(r=t.replies)?void 0:r.length)||0;return l!==o?o-l:new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()}default:return new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()}}),e},[de,P,W]),ue=e.useCallback(async()=>{if(y){M(!0),U(null);try{const e=await fetch(`/api/posts/${y}`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);const t=(await e.json()).postComments||[];z(t),V(!0)}catch(e){U(e instanceof Error?e.message:"Failed to load comments")}finally{M(!1)}}},[y]);e.useEffect(()=>{if(!c||!y)return z([]),U(null),J(""),Q(null),Y(""),ee({}),B(""),V(!1),se({isOpen:!1,commentId:null}),T.current=0,A.current=0,void(O.current=!1);if(U(null),J(""),Q(null),Y(""),ee({}),N&&N.length>0){if(N.some(e=>e.replies&&e.replies.length>0)){const e=ie(N);z(e),V(!0)}else{const e=N.map(e=>{var t;return{id:e.id,userId:e.userId,postId:e.postId,comment:e.comment,username:(null==(t=e.commenter)?void 0:t.username)||"Unknown User",parentId:e.parentId,created_at:e.createdAt,updated_at:e.updatedAt,commenter:e.commenter,likes:e.likes||0,isLiked:e.isLiked||!1}});z(e),V(!0)}ue()}else ue()},[c,y,N,ue,ie]);const pe=e.useCallback(e=>{const t=new Date,s=new Date(e),r=Math.floor((t.getTime()-s.getTime())/36e5);if(r<1)return"just now";if(r<24)return`${r}h ago`;const a=Math.floor(r/24);return a<7?`${a}d ago`:s.toLocaleDateString()},[]),he=e.useCallback(async()=>{if(I&&q.trim()){F(!0),U(null);try{const e=await t.createComment({comment:q.trim(),postId:y}),s={id:e.comment.id,userId:I.id,postId:y,comment:q.trim(),username:I.username,parentId:null,created_at:e.comment.createdAt,updated_at:e.comment.updatedAt,commenter:{id:I.id,username:I.username,firstName:I.firstName||"",lastName:I.lastName||"",profileImage:I.profileImage||"/default-avatar.png"},likes:0,isLiked:!1};ae(e=>{const t=new Map(e);return t.set(s.id,{isLiked:!1,likeCount:0}),t}),z(e=>{const t=[s,...e];return le("add",t.length),t}),J("")}catch(e){U("Failed to add comment")}finally{F(!1)}}},[I,q,y,le]),fe=e.useCallback(e=>{for(const t of de){if(t.id===e)return t;if(t.replies)for(const s of t.replies)if(s.id===e)return s}return null},[de]),xe=e.useCallback(async e=>{var s;if(I&&X.trim()){F(!0),U(null);try{const r=fe(e),a=(null==(s=null==r?void 0:r.commenter)?void 0:s.username)||"",n=await t.createReply({comment:X.trim(),postId:y,parentId:e,replyToUsername:a}),l={id:n.comment.id,userId:I.id,postId:y,comment:X.trim(),username:I.username,parentId:e,created_at:n.comment.createdAt,updated_at:n.comment.updatedAt,commenter:{id:I.id,username:I.username,firstName:I.firstName||"",lastName:I.lastName||"",profileImage:I.profileImage||"/default-avatar.png"},likes:0,isLiked:!1};ae(e=>{const t=new Map(e);return t.set(l.id,{isLiked:!1,likeCount:0}),t}),z(e=>{const t=[...e,l];return le("add",t.length),t}),Y(""),Q(null)}catch(r){U("Failed to add reply")}finally{F(!1)}}},[I,X,y,fe,le]),ge=e.useCallback(async(e,s)=>{U(null);try{await t.updateComment(e,s),z(t=>t.map(t=>t.id===e?{...t,comment:s,updated_at:(new Date).toISOString()}:t)),O.current=!0}catch(r){throw U("Failed to update comment"),r}},[]),be=e.useCallback(async e=>{U(null);try{await t.deleteComment(y,e),z(t=>{const s=t.filter(t=>t.id!==e&&t.parentId!==e);return le("delete",s.length),s})}catch(s){throw U("Failed to delete comment"),s}},[y,le]),je=e.useCallback(async(e,t,s)=>{void 0!==t&&void 0!==s&&(ae(r=>{const a=new Map(r);return a.set(e,{isLiked:t,likeCount:s}),a}),z(r=>r.map(r=>r.id===e?{...r,likes:s,isLiked:t}:r)))},[]),ve=e.useCallback(e=>{se({isOpen:!0,commentId:e})},[]),ye=e.useCallback(()=>{se({isOpen:!1,commentId:null})},[]),Ne=e.useCallback(e=>{ee(t=>({...t,[e]:!t[e]}))},[]),we=e.useCallback(()=>{V(!1),U(null),ue()},[ue]),ke=e.useCallback(e=>{E.current&&!E.current.contains(e.target)&&oe()},[oe]);if(e.useEffect(()=>{const e=e=>{"Escape"===e.key&&oe()};return c&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[c,oe]),!c)return null;const Ce=R.length,Ie=me.length,Ee=D&&!H;return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:ke,children:o.jsxs("div",{ref:E,className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-orange-500 to-slate-600 rounded-full flex items-center justify-center",children:o.jsx(m,{className:"text-white",size:20})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Comments"}),o.jsxs("p",{className:"text-sm text-gray-600",children:[Ce," ",1===Ce?"comment":"comments",P&&Ie!==Ce&&o.jsxs("span",{children:[" â€¢ ",Ie," shown"]})]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:we,disabled:D,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",title:"Refresh comments",children:o.jsx(h,{size:18,className:D?"animate-spin":""})}),o.jsx("button",{onClick:oe,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsx(d,{size:18})})]})]}),o.jsxs("div",{className:"p-4 border-b border-gray-100 space-y-3",children:[o.jsxs("div",{className:"relative",children:[o.jsx(f,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),o.jsx("input",{type:"text",placeholder:"Search comments...",value:P,onChange:e=>B(e.target.value),className:"w-full pl-9 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(x,{size:16,className:"text-gray-500"}),o.jsxs("select",{value:W,onChange:e=>G(e.target.value),className:"border border-gray-300 rounded-lg px-3 py-1 text-sm focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[o.jsx("option",{value:"newest",children:"Newest first"}),o.jsx("option",{value:"oldest",children:"Oldest first"}),o.jsx("option",{value:"popular",children:"Most popular"})]})]})]}),I&&o.jsx("div",{className:"p-4 border-b border-gray-100",children:o.jsxs("div",{className:"flex gap-3",children:[o.jsx(l,{to:`/users/${I.id}`,className:"flex-shrink-0",children:o.jsx("img",{src:I.profileImage||"/default-avatar.png",alt:I.username,className:"w-10 h-10 rounded-full object-cover border-2 border-slate-200 hover:border-orange-500 transition-colors",onError:e=>{e.target.src="/default-avatar.png"}})}),o.jsx("div",{className:"flex-1",children:o.jsxs("div",{className:"relative",children:[o.jsx("textarea",{value:q,onChange:e=>J(e.target.value),placeholder:"Write a comment...",className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 resize-none",rows:3,disabled:$}),o.jsx("button",{onClick:he,disabled:!q.trim()||$,className:"absolute bottom-3 right-3 p-2 bg-orange-500 text-white rounded-full hover:bg-orange-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:$?o.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):o.jsx(g,{size:16})})]})})]})}),o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[_&&o.jsxs("div",{className:"p-4 m-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-700",children:[o.jsx(b,{size:16}),o.jsx("span",{children:_}),o.jsx("button",{onClick:we,className:"ml-auto text-red-600 hover:text-red-800 font-medium",children:"Retry"})]}),Ee?o.jsx("div",{className:"p-8 text-center",children:o.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-600",children:[o.jsx(u,{className:"animate-spin",size:20}),"Loading comments..."]})}):0===me.length?o.jsxs("div",{className:"p-8 text-center",children:[o.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(m,{className:"text-gray-400",size:24})}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:P?"No comments found":"No comments yet"}),o.jsx("p",{className:"text-gray-600 mb-4",children:P?"Try adjusting your search terms":"Be the first to share your thoughts!"}),P&&o.jsx("button",{onClick:()=>B(""),className:"text-orange-600 hover:text-orange-700 font-medium",children:"Clear search"})]}):o.jsx("div",{className:"p-4 space-y-6",children:me.map(e=>o.jsx(r,{comment:e,depth:0,maxDepth:5,sessionUser:I,postUser:void 0,allComments:me,replyToComment:K,setReplyToComment:Q,replyText:X,setReplyText:Y,handleAddReply:xe,isSubmitting:$,formatTimeAgo:pe,showAllReplies:Z,toggleShowAllReplies:Ne,onEdit:ge,onDelete:be,onLikeToggle:je,onShowLikes:ve},e.id))})]}),o.jsx("div",{className:"p-4 border-t border-gray-100 bg-gray-50 rounded-b-2xl",children:o.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[o.jsx("div",{className:"flex items-center gap-4",children:o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(p,{size:14}),Ce," ",1===Ce?"participant":"participants"]})}),!I&&o.jsx("div",{className:"text-right",children:o.jsxs("span",{children:[o.jsx("a",{href:"/login",className:"text-orange-600 hover:text-orange-700 font-medium",children:"Sign in"})," ","to join the conversation"]})})]})})]})}),te.isOpen&&te.commentId&&o.jsx(v,{isOpen:te.isOpen,onClose:ye,commentId:te.commentId,initialCount:0})]})};export{y as C,j as u};
