const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CsQWAdtF.js","assets/react-vendor-DWDxyCYt.js","assets/redux-vendor-s9F9CGgp.js","assets/router-vendor-DqRelNZw.js","assets/ui-vendor-LOG_mfyu.js","assets/index-gQtHSoQI.js","assets/index-DtXEwmLu.js","assets/index-DQEQ7fGT.css","assets/index-DrR4kp2-.js","assets/index-B2iRlEpK.js","assets/index-6WYjbOfc.js","assets/index-Cuxq7srI.js","assets/index-8B5_arPj.js","assets/index-CT6_89OO.js","assets/index-CR9dXD9s.js","assets/index-CD7FmeAG.js","assets/index-Dg8Zjgx3.js","assets/CommentThread-8lV8dGCX.js","assets/EventsCard-DK8GV-7r.js","assets/PostMenu-C289LTnX.js","assets/CommentModal-Bo2mewch.js","assets/index-BPUJ9lVA.js","assets/index-BeXkyxaq.js","assets/index-QysSuFnN.js","assets/index-CLbvhZog.js","assets/PostDetails-LSzROab1.js","assets/PostsFeed-IFnYDbPD.js","assets/index-BcT7bw60.js","assets/index-DNZcu9jg.js","assets/index-BdQRQdHq.js","assets/index-glUGq1e0.js","assets/index-B7_9-FDp.js","assets/index-B8D6p6NW.js"])))=>i.map(i=>d[i]);
import{r as e,b as t,c as r}from"./react-vendor-DWDxyCYt.js";import{u as s,a,P as n}from"./redux-vendor-s9F9CGgp.js";import{u as o,L as i,a as l,b as c,O as d,c as u,j as h,r as p,d as m,R as g}from"./router-vendor-DqRelNZw.js";import{L as f,X as x,E as w,a as j,U as y,S as b,b as v,c as N,H as E,C as P,d as _,e as I,P as k,f as T,M as C,g as O,h as $,F as D,G as S,i as R,j as z,k as L,A,l as q}from"./ui-vendor-LOG_mfyu.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var F={exports:{}},U={},G=e,M=Symbol.for("react.element"),V=Symbol.for("react.fragment"),W=Object.prototype.hasOwnProperty,B=G.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Y={key:!0,ref:!0,__self:!0,__source:!0};function H(e,t,r){var s,a={},n=null,o=null;for(s in void 0!==r&&(n=""+r),void 0!==t.key&&(n=""+t.key),void 0!==t.ref&&(o=t.ref),t)W.call(t,s)&&!Y.hasOwnProperty(s)&&(a[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===a[s]&&(a[s]=t[s]);return{$$typeof:M,type:e,key:n,ref:o,props:a,_owner:B.current}}U.Fragment=V,U.jsx=H,U.jsxs=H,F.exports=U;var J=F.exports,K={},Q=t;function X(e){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Z(e){var t=function(e,t){if("object"!=X(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t);if("object"!=X(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==X(t)?t:t+""}function ee(e,t,r){return(t=Z(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(Object(r),!0).forEach(function(t){ee(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function se(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}K.createRoot=Q.createRoot,K.hydrateRoot=Q.hydrateRoot;var ae="function"==typeof Symbol&&Symbol.observable||"@@observable",ne=function(){return Math.random().toString(36).substring(7).split("").join(".")},oe={INIT:"@@redux/INIT"+ne(),REPLACE:"@@redux/REPLACE"+ne(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+ne()}};var ie=function e(t,r,s){var a;if("function"==typeof r&&"function"==typeof s||"function"==typeof s&&"function"==typeof arguments[3])throw new Error(se(0));if("function"==typeof r&&void 0===s&&(s=r,r=void 0),void 0!==s){if("function"!=typeof s)throw new Error(se(1));return s(e)(t,r)}if("function"!=typeof t)throw new Error(se(2));var n=t,o=r,i=[],l=i,c=!1;function d(){l===i&&(l=i.slice())}function u(){if(c)throw new Error(se(3));return o}function h(e){if("function"!=typeof e)throw new Error(se(4));if(c)throw new Error(se(5));var t=!0;return d(),l.push(e),function(){if(t){if(c)throw new Error(se(6));t=!1,d();var r=l.indexOf(e);l.splice(r,1),i=null}}}function p(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error(se(7));if(void 0===e.type)throw new Error(se(8));if(c)throw new Error(se(9));try{c=!0,o=n(o,e)}finally{c=!1}for(var t=i=l,r=0;r<t.length;r++){(0,t[r])()}return e}return p({type:oe.INIT}),(a={dispatch:p,subscribe:h,getState:u,replaceReducer:function(e){if("function"!=typeof e)throw new Error(se(10));n=e,p({type:oe.REPLACE})}})[ae]=function(){var e,t=h;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(se(11));function r(){e.next&&e.next(u())}return r(),{unsubscribe:t(r)}}})[ae]=function(){return this},e},a};function le(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function ce(e){return function(t){var r=t.dispatch,s=t.getState;return function(t){return function(a){return"function"==typeof a?a(r,s,e):t(a)}}}}var de=ce();de.withExtraArgument=ce;const ue="session/setUser",he="session/removeUser",pe=e=>({type:ue,payload:e}),me=()=>({type:he}),ge=e=>async t=>{try{const s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok){const e=await s.json();try{const e=await fetch("/api/auth/");if(e.ok){const r=await e.json();if(r.authenticated&&r.user)return t(pe(r.user)),null;if(!r.errors)return t(pe(r)),null}}catch(r){}return t(pe(e)),null}if(s.status<500){return await s.json()}return{server:"Something went wrong. Please try again"}}catch(s){return{server:"Network error occurred"}}},fe={user:null};const xe=function(e){for(var t=Object.keys(e),r={},s=0;s<t.length;s++){var a=t[s];"function"==typeof e[a]&&(r[a]=e[a])}var n,o=Object.keys(r);try{!function(e){Object.keys(e).forEach(function(t){var r=e[t];if(void 0===r(void 0,{type:oe.INIT}))throw new Error(se(12));if(void 0===r(void 0,{type:oe.PROBE_UNKNOWN_ACTION()}))throw new Error(se(13))})}(r)}catch(i){n=i}return function(e,t){if(void 0===e&&(e={}),n)throw n;for(var s=!1,a={},i=0;i<o.length;i++){var l=o[i],c=r[l],d=e[l],u=c(d,t);if(void 0===u)throw t&&t.type,new Error(se(14));a[l]=u,s=s||u!==d}return(s=s||o.length!==Object.keys(e).length)?a:e}}({session:function(e=fe,t){switch(t.type){case ue:return{...e,user:t.payload};case he:return{...e,user:null};default:return e}}});let we;we=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),s=function(){throw new Error(se(15))},a={getState:r.getState,dispatch:function(){return s.apply(void 0,arguments)}},n=t.map(function(e){return e(a)});return s=le.apply(void 0,n)(r.dispatch),re(re({},r),{},{dispatch:s})}}}(de);const je={},ye=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),r=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));s=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in je)return;je[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":"modulepreload",t||(a.as="script"),a.crossOrigin="",a.href=e,r&&a.setAttribute("nonce",r),document.head.appendChild(a),t?new Promise((t,r)=>{a.addEventListener("load",t),a.addEventListener("error",()=>r(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return s.then(t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)})},be=e.createContext(void 0),ve=({children:t})=>{const[r,s]=e.useState(null),a=()=>{s(null)};return J.jsxs(be.Provider,{value:{modalContent:r,setModalContent:s,closeModal:a},children:[t,r&&J.jsxs("div",{id:"modal",children:[J.jsx("div",{id:"modal-background",onClick:a}),J.jsx("div",{id:"modal-content",children:r})]})]})},Ne=()=>{const t=e.useContext(be);if(!t)throw new Error("useModal must be used within a ModalProvider");return t},Ee=({itemText:e,onItemClick:t,modalComponent:r,className:s=""})=>{const{setModalContent:a}=Ne();return J.jsx("span",{onClick:()=>{t&&t(),a(r)},className:s,children:e})},Pe=({navigate:t})=>{const r=s(),a=o(),{closeModal:n}=Ne(),[i,l]=e.useState(""),[c,d]=e.useState(""),[u,h]=e.useState({}),[p,m]=e.useState(!1),[g,b]=e.useState(!1),v=i.length<4||c.length<6,N=t||a,E=()=>{n()};return e.useEffect(()=>{const e=()=>{E()};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)}),J.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md transform transition-all duration-300 scale-100 animate-in fade-in-0 zoom-in-95 mx-4",children:[J.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[J.jsxs("div",{className:"flex items-center gap-3",children:[J.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-orange-400 to-orange-600 rounded-full flex items-center justify-center",children:J.jsx(f,{size:20,className:"text-white"})}),J.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Welcome Back"})]}),J.jsx("button",{onClick:E,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-slate-100 transition-colors",children:J.jsx(x,{size:20,className:"text-slate-500"})})]}),J.jsxs("form",{onSubmit:async e=>{e.preventDefault(),b(!0),h({});try{const e=await r(ge({email:i,password:c}));e?h(e):(E(),N("/"))}catch{h({server:"Something went wrong. Please try again."})}finally{b(!1)}},className:"p-6 space-y-6",children:[u.server&&J.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm font-medium",children:u.server}),J.jsxs("div",{className:"space-y-2",children:[J.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold text-slate-700",children:"Email Address"}),J.jsx("input",{id:"email",type:"email",value:i,onChange:e=>l(e.target.value),placeholder:"Enter your email",className:`w-full px-4 py-3 border-2 rounded-xl transition-all duration-200 ${u.email?"border-red-300 focus:border-red-500 focus:ring-red-200":"border-slate-200 focus:border-orange-400 focus:ring-orange-100"} focus:outline-none focus:ring-4`,required:!0}),u.email&&J.jsx("p",{className:"text-red-600 text-sm font-medium",children:u.email})]}),J.jsxs("div",{className:"space-y-2",children:[J.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-slate-700",children:"Password"}),J.jsxs("div",{className:"relative",children:[J.jsx("input",{id:"password",type:p?"text":"password",value:c,onChange:e=>d(e.target.value),placeholder:"Enter your password",className:`w-full px-4 py-3 pr-12 border-2 rounded-xl transition-all duration-200 ${u.password?"border-red-300 focus:border-red-500 focus:ring-red-200":"border-slate-200 focus:border-orange-400 focus:ring-orange-100"} focus:outline-none focus:ring-4`,required:!0}),J.jsx("button",{type:"button",onClick:()=>m(!p),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors",children:p?J.jsx(w,{size:20}):J.jsx(j,{size:20})})]}),u.password&&J.jsx("p",{className:"text-red-600 text-sm font-medium",children:u.password})]}),J.jsxs("div",{className:"space-y-3",children:[J.jsx("button",{type:"submit",disabled:v||g,className:"w-full py-3 px-4 rounded-xl font-semibold text-white transition-all duration-200 "+(v||g?"bg-slate-300 cursor-not-allowed":"bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 hover:shadow-lg hover:-translate-y-0.5 active:translate-y-0"),children:g?J.jsxs("div",{className:"flex items-center justify-center gap-2",children:[J.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Signing In..."]}):"Log In"}),J.jsxs("button",{type:"button",onClick:async e=>{e.preventDefault(),b(!0),h({});try{const e=await r(ge({email:"demo@aa.io",password:"password"}));e?h(e):(E(),N("/"))}catch{h({server:"Something went wrong. Please try again."})}finally{b(!1)}},disabled:g,className:"w-full py-3 px-4 rounded-xl font-semibold text-slate-700 bg-slate-100 hover:bg-slate-200 transition-all duration-200 hover:shadow-md hover:-translate-y-0.5 active:translate-y-0 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[J.jsx(y,{size:18}),"Try Demo Account"]})]})]}),J.jsx("div",{className:"px-6 pb-6 text-center",children:J.jsxs("p",{className:"text-sm text-slate-600",children:["Don't have an account?"," ",J.jsx("button",{onClick:()=>{E(),N("/signup")},className:"text-orange-600 hover:text-orange-700 font-semibold transition-colors",children:"Sign up here"})]})})]})},_e=({className:e="",size:t="md"})=>J.jsx("div",{className:`${{sm:"w-8 h-8",md:"w-10 h-10",lg:"w-12 h-12"}[t]} ${e} relative`,children:J.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-full h-full",children:[J.jsxs("defs",{children:[J.jsxs("linearGradient",{id:"logoGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[J.jsx("stop",{offset:"0%",stopColor:"#f59e0b"}),J.jsx("stop",{offset:"100%",stopColor:"#d97706"})]}),J.jsxs("linearGradient",{id:"heartGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[J.jsx("stop",{offset:"0%",stopColor:"#ffffff"}),J.jsx("stop",{offset:"100%",stopColor:"#f8fafc"})]}),J.jsx("filter",{id:"dropShadow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:J.jsx("feDropShadow",{dx:"0",dy:"2",stdDeviation:"2",floodColor:"#000000",floodOpacity:"0.1"})})]}),J.jsx("circle",{cx:"20",cy:"20",r:"18",fill:"url(#logoGradient)",filter:"url(#dropShadow)",className:"drop-shadow-lg"}),J.jsx("circle",{cx:"20",cy:"20",r:"15",fill:"none",stroke:"rgba(255,255,255,0.2)",strokeWidth:"0.5"}),J.jsx("path",{d:"M20 28c-1.5-1.2-6-4.8-6-9 0-2.2 1.8-4 4-4 1.1 0 2.1.4 2.8 1.2.7-.8 1.7-1.2 2.8-1.2 2.2 0 4 1.8 4 4 0 4.2-4.5 7.8-6 9z",fill:"url(#heartGradient)",className:"drop-shadow-sm"}),J.jsx("ellipse",{cx:"26",cy:"14",rx:"1.5",ry:"2.5",fill:"rgba(255,255,255,0.9)",className:"animate-pulse",style:{animationDuration:"3s",animationDelay:"1s"}}),J.jsx("path",{d:"M12 22c-1 0-2 .5-2 1.5s1 1.5 2 1.5h2v-3h-2z",fill:"rgba(255,255,255,0.8)"}),J.jsx("path",{d:"M28 22c1 0 2 .5 2 1.5s-1 1.5-2 1.5h-2v-3h2z",fill:"rgba(255,255,255,0.8)"}),J.jsx("path",{d:"M16 12v4l2-2 2 2v-4",stroke:"rgba(255,255,255,0.6)",strokeWidth:"1",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})]})}),Ie=e.memo(({to:e,icon:t,label:r,onClick:s,className:a="",isActive:n=!1})=>{const o="flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200",l=n?"bg-orange-100 text-orange-700 shadow-sm":"text-slate-600 hover:text-slate-900 hover:bg-slate-100";return e?J.jsxs(i,{to:e,onClick:s,className:`${o} ${l} ${a}`,children:[J.jsx(t,{size:18}),J.jsx("span",{children:r})]}):J.jsxs("button",{onClick:s,className:`${o} ${l} w-full text-left ${a}`,children:[J.jsx(t,{size:18}),J.jsx("span",{children:r})]})});Ie.displayName="NavigationItem";const ke=e.memo(({src:t,alt:r,className:s,fallbackSrc:a="/default-avatar.png"})=>{const[n,o]=e.useState(t),[i,l]=e.useState(!1);e.useEffect(()=>{o(t),l(!1)},[t]);const c=e.useCallback(()=>{i||n===a||(l(!0),o(a))},[n,i,a]);return J.jsx("img",{src:n,alt:r,className:s,onError:c})});ke.displayName="ProfileImage";const Te=e.memo(({user:e,onLogout:t,onCloseMenu:r,isMobile:s=!1})=>s?J.jsxs("div",{className:"pt-4 border-t border-slate-200 space-y-2",children:[J.jsxs("div",{className:"flex items-center space-x-3 px-4 py-3",children:[J.jsx(ke,{src:e.profileImage,alt:e.username,className:"w-12 h-12 rounded-full object-cover border-2 border-slate-200"}),J.jsxs("div",{children:[J.jsxs("p",{className:"font-semibold text-slate-900",children:[e.firstName," ",e.lastName]}),J.jsxs("p",{className:"text-sm text-slate-500",children:["@",e.username]})]})]}),J.jsx(Ie,{to:"/profile",icon:y,label:"View Profile",onClick:r,className:"text-slate-700 hover:bg-slate-100"}),J.jsx(Ie,{to:`/users/${e.id}/profile/update`,icon:b,label:"Settings",onClick:r,className:"text-slate-700 hover:bg-slate-100"}),J.jsx(Ie,{icon:v,label:"Sign Out",onClick:()=>{t(),r()},className:"text-red-600 hover:bg-red-50 hover:text-red-700"})]}):J.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-xl shadow-xl border border-slate-200 py-2 z-50 animate-in fade-in-0 zoom-in-95 duration-200",children:[J.jsx("div",{className:"px-4 py-3 border-b border-slate-100",children:J.jsxs("div",{className:"flex items-center space-x-3",children:[J.jsx(ke,{src:e.profileImage,alt:e.username,className:"w-12 h-12 rounded-full object-cover"}),J.jsxs("div",{children:[J.jsxs("p",{className:"font-semibold text-slate-900",children:[e.firstName," ",e.lastName]}),J.jsx("p",{className:"text-sm text-slate-500",children:e.email})]})]})}),J.jsxs("div",{className:"py-2",children:[J.jsx(Ie,{to:"/profile",icon:y,label:"View Profile",onClick:r,className:"text-slate-700 hover:bg-slate-50"}),J.jsx(Ie,{to:`/users/${e.id}/profile/update`,icon:b,label:"Settings",onClick:r,className:"text-slate-700 hover:bg-slate-50"}),J.jsx(Ie,{to:"/profile-feed",icon:N,label:"Similar to You",onClick:r,className:"text-slate-700 hover:bg-slate-50"})]}),J.jsx("div",{className:"border-t border-slate-100 pt-2",children:J.jsx(Ie,{icon:v,label:"Sign Out",onClick:()=>{t(),r()},className:"text-red-600 hover:bg-red-50 hover:text-red-700 w-full text-left"})})]}));Te.displayName="UserMenu";const Ce=e.memo(()=>{const t=a(e=>e.session.user),r=(n=t)?"object"==typeof n&&"user"in n&&"authenticated"in n&&n.user&&n.authenticated?n.user:"object"==typeof n&&"id"in n&&"username"in n&&"number"==typeof n.id&&"string"==typeof n.username?n:null:null;var n;const c=s(),d=o(),u=l(),[h,p]=e.useState(!1),[m,g]=e.useState(!1),[f,w]=e.useState(!1),j=e.useRef(null),y=e.useRef(null),b=e.useMemo(()=>r?[{path:"/",label:"Home",icon:E},{path:"/groups",label:"Groups",icon:N},{path:"/events",label:"Events",icon:P},{path:"/posts-feed",label:"Feed",icon:_},{path:"/profile-feed",label:"Similar To You",icon:I},{path:"/posts/create",label:"Share Story",icon:k}]:[{path:"/",label:"Home",icon:E},{path:"/groups",label:"Groups",icon:N},{path:"/events",label:"Events",icon:P}],[r]),v=e.useCallback(async()=>{try{await c(async e=>{try{await fetch("/api/auth/logout"),e(me()),"undefined"!=typeof window&&(window.sessionStorage.clear(),window.localStorage.removeItem("userPreferences"))}catch(t){e(me())}}),g(!1),d("/",{replace:!0})}catch(e){}},[c,d]),O=e.useCallback(()=>{p(e=>!e),g(!1)},[]),$=e.useCallback(()=>{g(e=>!e),p(!1)},[]),D=e.useCallback(()=>{p(!1)},[]),S=e.useCallback(()=>{g(!1)},[]),R=e.useCallback(e=>u.pathname===e,[u.pathname]);return e.useEffect(()=>{const e=()=>{w(window.scrollY>10)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),e.useEffect(()=>{const e=e=>{j.current&&!j.current.contains(e.target)&&g(!1),y.current&&!y.current.contains(e.target)&&p(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),e.useEffect(()=>{p(!1),g(!1)},[u.pathname]),J.jsxs(J.Fragment,{children:[J.jsxs("nav",{className:"fixed top-0 left-0 right-0 z-50 transition-all duration-300 "+(f?"bg-white/95 backdrop-blur-md shadow-lg border-b border-slate-200/50":"bg-white/90 backdrop-blur-sm"),children:[J.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:J.jsxs("div",{className:"flex items-center justify-between h-16 lg:h-20",children:[J.jsxs(i,{to:"/",className:"flex items-center space-x-3 group",children:[J.jsx(_e,{size:"md",className:"group-hover:scale-105 transition-transform duration-300 drop-shadow-lg group-hover:drop-shadow-xl"}),J.jsx("div",{className:"hidden sm:block",children:J.jsx("h1",{className:"text-xl lg:text-2xl mb-0 font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"MEN CRY TOO"})})]}),J.jsx("div",{className:"hidden lg:flex items-center space-x-1",children:b.map(({path:e,label:t,icon:r})=>J.jsx(Ie,{to:e,icon:r,label:t,isActive:R(e)},e))}),J.jsxs("div",{className:"flex items-center space-x-3",children:[r?J.jsxs("div",{className:"relative",ref:j,children:[J.jsxs("button",{onClick:$,className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-slate-100 transition-all duration-200 group",children:[J.jsxs("div",{className:"relative",children:[J.jsx(ke,{src:r.profileImage,alt:r.username,className:"w-8 h-8 lg:w-10 lg:h-10 rounded-full object-cover border-2 border-slate-200 group-hover:border-orange-300 transition-all duration-200"}),J.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 border-2 border-white rounded-full"})]}),J.jsxs("div",{className:"hidden lg:block text-left",children:[J.jsx("p",{className:"text-sm font-semibold text-slate-900",children:r.firstName}),J.jsxs("p",{className:"text-xs text-slate-500",children:["@",r.username]})]}),J.jsx(T,{size:16,className:"hidden lg:block text-slate-400 transition-transform duration-200 "+(m?"rotate-180":"")})]}),m&&J.jsx(Te,{user:r,onLogout:v,onCloseMenu:S})]}):J.jsxs("div",{className:"hidden lg:flex items-center space-x-3",children:[J.jsx(Ee,{itemText:"Sign In",modalComponent:J.jsx(Pe,{}),className:"px-4 py-2 text-slate-600 hover:text-slate-900 font-medium transition-colors duration-200 cursor-pointer"}),J.jsx(i,{to:"/signup",className:"px-6 py-2 bg-gradient-to-r from-orange-500 to-orange-600 text-white font-semibold rounded-lg hover:from-orange-600 hover:to-orange-700 transition-all duration-200 hover:shadow-lg hover:-translate-y-0.5",children:"Sign Up"})]}),J.jsx("button",{onClick:O,className:"lg:hidden flex items-center justify-center w-10 h-10 rounded-lg text-slate-600 hover:text-slate-900 hover:bg-slate-100 transition-all duration-200","aria-label":"Toggle mobile menu",children:h?J.jsx(x,{size:24}):J.jsx(C,{size:24})})]})]})}),h&&J.jsx("div",{ref:y,className:"lg:hidden bg-white border-t border-slate-200 shadow-lg animate-in slide-in-from-top-2 duration-200",children:J.jsxs("div",{className:"px-4 py-4 space-y-2",children:[b.map(({path:e,label:t,icon:r})=>J.jsx(Ie,{to:e,icon:r,label:t,onClick:D,isActive:R(e),className:R(e)?"bg-orange-100 text-orange-700":"text-slate-600 hover:text-slate-900 hover:bg-slate-100"},e)),!r&&J.jsxs("div",{className:"pt-4 border-t border-slate-200 space-y-3",children:[J.jsx(Ee,{itemText:"Sign In",modalComponent:J.jsx(Pe,{}),className:"flex items-center justify-center w-full px-4 py-3 text-slate-600 hover:text-slate-900 font-medium border border-slate-300 rounded-lg hover:bg-slate-50 transition-all duration-200 cursor-pointer"}),J.jsx(i,{to:"/signup",className:"flex items-center justify-center w-full px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white font-semibold rounded-lg hover:from-orange-600 hover:to-orange-700 transition-all duration-200",onClick:D,children:"Sign Up"})]}),r&&J.jsx(Te,{user:r,onLogout:v,onCloseMenu:D,isMobile:!0})]})})]}),J.jsx("div",{className:"h-16 lg:h-20"})]})});Ce.displayName="Navigation";const Oe=()=>{const e=(new Date).getFullYear(),t=[{name:"Portfolio",href:"https://tayondw.github.io/",icon:D,color:"hover:text-purple-400",description:"View my portfolio"},{name:"GitHub",href:"https://github.com/Tayondw",icon:S,color:"hover:text-gray-300",description:"Check out my code"},{name:"LinkedIn",href:"https://www.linkedin.com/in/tayon",icon:R,color:"hover:text-blue-400",description:"Connect with me professionally"},{name:"Resume",href:"/assets/Williams-Tayon-SWE.pdf",icon:z,color:"hover:text-green-400",description:"Download my resume",download:!0}];return J.jsxs("footer",{className:"bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-white",children:[J.jsx("div",{className:"flex mx-auto px-4 sm:px-6 lg:px-8 py-6 justify-around",children:J.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8 items-center",children:[J.jsxs("div",{className:"lg:col-span-1 text-center lg:text-left",children:[J.jsxs("div",{className:"flex items-center gap-2 justify-center lg:justify-start mb-4",children:[J.jsx(O,{size:24,className:"text-orange-400"}),J.jsx("h3",{className:"text-xl font-bold text-orange-400",children:"MEET THE DEVELOPER"})]}),J.jsx("h4",{className:"text-2xl font-semibold text-white mb-2 text-center",children:"Tayon Williams"}),J.jsxs("div",{className:"flex items-center gap-2 justify-center lg:justify-center text-slate-300 ",children:[J.jsx($,{size:16}),J.jsx("a",{href:"mailto:tayondw@gmail.com",className:"hover:text-orange-400 transition-colors duration-200",children:"tayondw@gmail.com"})]}),J.jsx("p",{className:"text-slate-400 text-sm mt-2 text-center",children:"Full Stack Software Engineer"})]}),J.jsx("div",{className:"lg:col-span-1 flex justify-center",children:J.jsxs("div",{className:"relative group",children:[J.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-orange-400 to-blue-500 rounded-full blur opacity-25 group-hover:opacity-75 transition duration-300"}),J.jsx("img",{src:"https://mencrytoo.s3.amazonaws.com/Proffesional-headshot-1.jpg",alt:"Tayon Williams - Professional Headshot",className:"relative w-32 h-32 lg:w-40 lg:h-40 rounded-full object-cover border-4 border-slate-700 group-hover:border-orange-400 transition-all duration-300 shadow-xl"}),J.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})}),J.jsxs("div",{className:"lg:col-span-1",children:[J.jsx("h4",{className:"text-lg font-semibold items-center lg:text-center text-slate-200",children:"Connect With Me"}),J.jsx("div",{className:"grid grid-cols-2 gap-4 justify-self-center",children:t.map(e=>{const t=e.icon;return J.jsx("div",{className:"group",children:e.download?J.jsxs("a",{href:e.href,download:"Williams-Tayon-SWE.pdf",className:`flex items-center gap-3 p-3 rounded-lg bg-slate-800/50 hover:bg-slate-700/50 transition-all duration-200 ${e.color} group-hover:transform group-hover:scale-105`,title:e.description,children:[J.jsx(t,{size:20}),J.jsx("span",{className:"font-medium",children:e.name}),J.jsx(L,{size:14,className:"ml-auto opacity-0 group-hover:opacity-100 transition-opacity"})]}):J.jsxs(i,{to:e.href,target:"_blank",rel:"noopener noreferrer",className:`flex items-center gap-3 p-3 rounded-lg bg-slate-800/50 hover:bg-slate-700/50 transition-all duration-200 ${e.color} group-hover:transform group-hover:scale-105`,title:e.description,children:[J.jsx(t,{size:20}),J.jsx("span",{className:"font-medium",children:e.name}),J.jsx(L,{size:14,className:"ml-auto opacity-0 group-hover:opacity-100 transition-opacity"})]})},e.name)})})]}),J.jsxs("div",{className:"lg:col-span-1 text-center lg:text-center",children:[J.jsx("h4",{className:"text-lg font-semibold mb-4 text-slate-200",children:"About This Project"}),J.jsxs("div",{className:"space-y-3 justify-self-center",children:[J.jsxs("div",{className:"flex items-center gap-2 justify-center lg:justify-start text-slate-300",children:[J.jsx(I,{size:16,className:"text-red-400"}),J.jsx("span",{className:"text-sm",children:"Built with passion for mental health"})]}),J.jsxs("div",{className:"flex items-center gap-2 justify-center lg:justify-start text-slate-300",children:[J.jsx(O,{size:16,className:"text-blue-400"}),J.jsx("span",{className:"text-sm",children:"React • JavaScript • TypeScript • Tailwind • Python"})]}),J.jsxs("div",{className:"flex items-center gap-2 justify-center lg:justify-start text-slate-300",children:[J.jsx(y,{size:16,className:"text-green-400"}),J.jsx("span",{className:"text-sm",children:"Supporting men's mental wellness"})]})]})]})]})}),J.jsx("div",{className:"border-t border-slate-700",children:J.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:J.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[J.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[J.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-orange-400 to-blue-500 bg-clip-text text-transparent",children:"MEN CRY TOO"}),J.jsxs("span",{className:"text-sm",children:["© ",e," All rights reserved"]})]}),J.jsx("div",{className:"text-center md:text-right",children:J.jsx("p",{className:"text-slate-400 text-sm italic",children:'"It\'s okay to cry" - Breaking stigma, building community'})})]})})})]})},$e=()=>{const{pathname:t}=l();return e.useEffect(()=>{window.scrollTo(0,0)},[t]),null},De=({message:e,showLogo:t=!0})=>{const r=c();return J.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 via-white to-slate-50 flex items-center justify-center",children:J.jsxs("div",{className:"text-center p-8",children:[t&&J.jsxs("div",{className:"mb-6",children:[J.jsx(_e,{size:"lg",className:"mx-auto animate-pulse transform hover:scale-110 transition-transform duration-300"}),J.jsx("h2",{className:"text-xl font-bold mt-2 bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"MEN CRY TOO"})]}),J.jsx("div",{className:"w-12 h-12 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),J.jsx("p",{className:"text-slate-600 font-medium mb-2 animate-pulse",children:(()=>{if(e)return e;switch(r.state){case"loading":return"Loading page...";case"submitting":return"Processing request...";default:return"Loading..."}})()}),J.jsx("p",{className:"text-slate-400 text-sm",children:"Please wait a moment"}),J.jsxs("div",{className:"flex justify-center space-x-1 mt-4",children:[J.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),J.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),J.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),J.jsx("div",{className:"w-64 h-1 bg-slate-200 rounded-full mx-auto mt-6 overflow-hidden",children:J.jsx("div",{className:"h-full bg-gradient-to-r from-orange-400 to-orange-600 animate-pulse rounded-full"})})]})})},Se=()=>{const{showLoader:t}=(()=>{const t=c(),r=l(),[s,a]=e.useState(!1),[n,o]=e.useState(!1);return e.useEffect(()=>{const e="loading"===t.state||"submitting"===t.state;if(e&&!s){a(!0);const e=setTimeout(()=>{o(!0)},100);return()=>clearTimeout(e)}!e&&s&&(a(!1),o(!1))},[t.state,s]),e.useEffect(()=>{a(!1),o(!1)},[r.pathname]),{isNavigating:"idle"!==t.state,showLoader:n,navigationState:t.state}})();return t?J.jsx("div",{className:"fixed inset-0 z-[60]",children:J.jsx(De,{})}):null},Re=e.memo(({children:t})=>{const r=s(),[a,n]=e.useState(!1);return e.useEffect(()=>{(async()=>{try{await r(async e=>{try{const t=await fetch("/api/auth/");if(t.ok){const r=await t.json();return r.errors?(e(me()),null):r.authenticated&&r.user?(e(pe(r.user)),r.user):r.id&&r.username?(e(pe(r)),r):(e(me()),null)}return e(me()),null}catch(t){return e(me()),null}})}catch(e){}finally{setTimeout(()=>{n(!0)},500)}})()},[r]),a?J.jsxs(ve,{children:[J.jsx(Ce,{}),J.jsx(Se,{})," ",J.jsx($e,{}),J.jsxs("div",{className:"relative overflow-hidden",children:[J.jsx("main",{className:"relative",children:t||J.jsx(d,{})}),J.jsx("div",{className:"clear-both h-0"}),J.jsx("div",{className:"absolute bottom-0 left-0 w-full h-1 bg-gradient-to-r from-orange-400 via-blue-500 to-purple-500"})]}),J.jsx(Oe,{})]}):J.jsx(De,{message:"Initializing application..."})});Re.displayName="Layout";const ze=({children:e})=>a(e=>e.session.user)?J.jsx(J.Fragment,{children:e}):(window.location.href="/",null),Le=({children:t})=>J.jsx(e.Suspense,{fallback:J.jsx(De,{}),children:t}),Ae=()=>{const e=u(),t=(()=>{if(e.data&&"object"==typeof e.data&&null!==e.data){const t=e.data;return"errors"in t&&t.errors,t}return null})(),{title:r,message:s,status:a}=(()=>{if(!e)return{title:"Unknown Error",message:"Something went wrong.",status:500};if(404===e.status)return{title:"Page Not Found",message:"The page you're looking for doesn't exist.",status:404};if(403===e.status)return{title:"Access Denied",message:"You don't have permission to access this page.",status:403};if(401===e.status)return{title:"Authentication Required",message:"Please log in to access this page.",status:401};let r=e.message||e.statusText||"An unexpected error occurred.";if(t&&"errors"in t){const e=t.errors;"object"==typeof e&&null!==e&&"message"in e&&(r=String(e.message))}return{title:"Something Went Wrong",message:r,status:e.status||500}})();return J.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-orange-50 to-slate-100 flex items-center justify-center p-4",children:J.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-lg border border-slate-200 p-8 text-center",children:[J.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:J.jsx(A,{size:32,className:"text-red-600"})}),J.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:r}),J.jsx("p",{className:"text-slate-600 mb-6",children:s}),J.jsxs("div",{className:"text-sm text-slate-500 mb-6",children:["Error Code: ",a]}),J.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[J.jsxs("button",{onClick:()=>window.history.back(),className:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:[J.jsx(q,{size:16}),"Go Back"]}),J.jsxs(i,{to:"/",className:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors",children:[J.jsx(E,{size:16}),"Home"]})]}),!1]})})},qe=async()=>{try{const e=await fetch("/api/auth/",{headers:{"Cache-Control":"max-age=30"}});if(!e.ok)return p("/login");const t=e.headers.get("content-type");if(!t||!t.includes("application/json"))return p("/login");const r=await e.json();return r.authenticated&&r.user?{user:r.user}:p("/login")}catch(e){return p("/login")}},Fe=new Map,Ue=e=>{if(e)for(const t of Fe.keys())t.includes(e)&&Fe.delete(t);else Fe.clear()};const Ge=async({request:e})=>{var t;const r=await e.formData(),s=r.get("intent"),a={};if("create-group"===s||"edit-group"===s){const e=r.get("name"),t=r.get("about"),n=r.get("type"),o=r.get("city"),i=r.get("state"),l=r.get("image");if((!e||e.length<3||e.length>50)&&(a.name="Group name must be between 3 and 50 characters"),(!t||t.length<20||t.length>150)&&(a.about="Description must be at least 20 characters and no more than 150 characters"),n||(a.type="Group Type is required"),(!o||o.length<3||o.length>30)&&(a.city="City name must be between 3 and 30 characters"),i&&2===i.length||(a.state="Please enter the abbreviated form of the state"),"create-group"!==s||l||(a.image="Group image is required to create a group"),Object.keys(a).length>0)return h({errors:a},{status:400})}try{switch(s){case"create-group":{const e=await fetch("/api/groups/new",{method:"POST",credentials:"include",body:r});if(e.ok){const r=await e.json();return(null==(t=r.group)?void 0:t.id)?(window.location.href=`/groups/${r.group.id}`,null):(window.location.href="/groups",null)}{const t=await e.json();return h({errors:t.errors||t},{status:400})}}case"edit-group":{const e=r.get("id");if(!e)return h({errors:{server:"Group ID is required"}},{status:400});const t=await fetch(`/api/groups/${e}/edit`,{method:"POST",credentials:"include",body:r});if(t.ok)return window.location.href=`/groups/${e}`,null;{const e=await t.json();return h({errors:e.errors||e},{status:400})}}default:return h({errors:{server:"Invalid form submission"}},{status:400})}}catch(n){return h({errors:{server:"Network error. Please try again"}},{status:500})}},Me=async({request:e})=>{var t;const r=await e.formData(),s=r.get("intent"),a={};if("create-event"===s||"edit-event"===s){const e=r.get("name"),t=r.get("description"),n=r.get("type"),o=r.get("capacity"),i=r.get("startDate"),l=r.get("endDate"),c=r.get("image");(!e||e.length<5||e.length>50)&&(a.name="Event name must be between 5 and 50 characters"),(!t||t.length<50||t.length>150)&&(a.description="Description must be at least 50 characters and no more than 150 characters"),n||(a.type="Event Type is required"),(!o||parseInt(o)<2||parseInt(o)>300)&&(a.capacity="Event capacity must have at least two people attending and cannot exceed more than 300 people");const d=new Date,u=new Date(i),p=new Date(l);if(!i||isNaN(u.getTime())?a.startDate="Invalid start date":u<d&&(a.startDate="Start date must be after or on the current date"),!l||isNaN(p.getTime())?a.endDate="Invalid end date":p<u&&(a.endDate="End date must be after the start date"),"create-event"!==s||c||(a.image="Event image is required to create an event"),Object.keys(a).length>0)return h({errors:a},{status:400})}try{switch(s){case"create-event":{const e=r.get("group_id");if(!e)return h({errors:{server:"Group ID is required"}},{status:400});const s=await fetch(`/api/groups/${e}/events/new`,{method:"POST",credentials:"include",body:r});if(s.ok){const e=null==(t=(await s.json()).event)?void 0:t.id;if(e)return"undefined"!=typeof window?(window.location.href=`/events/${e}`,null):p(`/events/${e}`);{const e=Date.now();return"undefined"!=typeof window?(window.location.href=`/events?refresh=${e}`,null):p(`/events?refresh=${e}`)}}{const e=await s.json();return h({errors:e},{status:400})}}case"edit-event":{const e=r.get("eventId"),t=r.get("group_id");if(!e||!t)return h({errors:{server:"Event ID and Group ID are required"}},{status:400});const s=await fetch(`/api/groups/${t}/events/${e}/edit`,{method:"POST",credentials:"include",body:r});if(s.ok){const t=Date.now();return"undefined"!=typeof window?(window.location.href=`/events/${e}?refresh=${t}`,null):p(`/events/${e}?refresh=${t}`)}{const e=await s.json();return h({errors:e},{status:400})}}default:return h({errors:{server:"Invalid form submission"}},{status:400})}}catch(n){return h({errors:{server:"Network error. Please try again"}},{status:500})}},Ve=new Map;function We(e){const t=Ve.get(e);return t&&Date.now()-t.timestamp<6e4?t.data:(Ve.delete(e),null)}function Be(e,t){Ve.set(e,{data:t,timestamp:Date.now()})}async function Ye(e,t,r,s){const a=We(s);if(a)return a;const n=await fetch(`/api/posts/${e}?page=${t}&per_page=${r}`,{headers:{"Cache-Control":"max-age=60"}});if(!n.ok){const e=await n.text();throw new Error(`HTTP ${n.status}: ${e}`)}const o=await n.json();return Be(s,o),o}async function He(){const e=We("feed-stats");if(e)return e;try{const e=await fetch("/api/posts/feed/stats",{headers:{"Cache-Control":"max-age=300"}});if(!e.ok)return{totalPosts:0,similarUsers:0,similarPosts:0,userTags:0};const t=await e.json();return Be("feed-stats",t),t}catch(t){return{totalPosts:0,similarUsers:0,similarPosts:0,userTags:0}}}const Je=async({request:e,params:t})=>{const r=await e.formData(),s=r.get("intent");try{switch(s){case"create-post":{const e=r.get("userId"),t=r.get("title"),s=r.get("caption"),a=r.get("image"),n={};if((!t||t.length<5||t.length>25)&&(n.title="Title must be between 5 and 25 characters"),(!s||s.length<50||s.length>500)&&(n.caption="Caption must be between 50 and 500 characters"),a&&0!==a.size||(n.image="Image is required"),e||(n.server="User ID is required"),Object.keys(n).length>0)return h({errors:n},{status:400});const o=new FormData;o.append("title",t),o.append("caption",s),o.append("image",a);const i=await fetch(`/api/users/${e}/posts/create`,{method:"POST",body:o});if(!i.ok){const e=await i.json();return h({errors:e},{status:400})}return Ue("posts"),Ue("profile"),p("/profile")}case"edit-post":{const e=r.get("postId")||t.postId,s=r.get("userId"),a=r.get("title"),n=r.get("caption"),o=r.get("image"),i={};if((!a||a.length<5||a.length>25)&&(i.title="Title must be between 5 and 25 characters"),(!n||n.length<50||n.length>500)&&(i.caption="Caption must be between 50 and 500 characters"),Object.keys(i).length>0)return h({errors:i},{status:400});const l=new FormData;l.append("title",a),l.append("caption",n),o&&o.size>0&&l.append("image",o);const c=await fetch(`/api/users/${s}/posts/${e}`,{method:"POST",body:l});if(!c.ok){const e=await c.json();return h({errors:e},{status:400})}return Ue(`post-${e}`),Ue("posts"),Ue("profile"),window.location.href="/profile"}case"delete-post":{const e=r.get("postId")||t.postId;if(!e)return h({error:"Post ID is required"},{status:400});return(await fetch(`/api/posts/${e}/delete`,{method:"DELETE"})).ok?(Ue(`post-${e}`),Ue("posts"),Ue("profile"),window.location.href="/profile"):h({error:"Failed to delete post"},{status:500})}case"like-post":{const e=r.get("postId")||t.postId;if(!e)return h({error:"Post ID is required"},{status:400});return(await fetch(`/api/posts/${e}/like`,{method:"POST",headers:{"Content-Type":"application/json"}})).ok?(Ue(`post-${e}`),Ue("posts"),h({success:!0})):h({error:"Failed to like post"},{status:500})}case"unlike-post":{const e=r.get("postId")||t.postId;if(!e)return h({error:"Post ID is required"},{status:400});return(await fetch(`/api/posts/${e}/unlike`,{method:"POST",headers:{"Content-Type":"application/json"}})).ok?(Ue(`post-${e}`),Ue("posts"),h({success:!0})):h({error:"Failed to unlike post"},{status:500})}default:return h({error:"Invalid action"},{status:400})}}catch(a){return h({error:"Network error. Please try again"},{status:500})}},Ke=new Map;function Qe(e){if(e)for(const t of Ke.keys())t.includes(e)&&Ke.delete(t);else Ke.clear()}const Xe=e.lazy(()=>ye(()=>import("./index-CsQWAdtF.js"),__vite__mapDeps([0,1,2,3,4]))),Ze=e.lazy(()=>ye(()=>import("./index-gQtHSoQI.js"),__vite__mapDeps([5,1,2,3,4]))),et=e.lazy(()=>ye(()=>import("./index-DtXEwmLu.js"),__vite__mapDeps([6,1,3,2,4,7]))),tt=e.lazy(()=>ye(()=>import("./index-DrR4kp2-.js"),__vite__mapDeps([8,1,3,2,4]))),rt=e.lazy(()=>ye(()=>import("./index-B2iRlEpK.js"),__vite__mapDeps([9,1,3,2,4]))),st=e.lazy(()=>ye(()=>import("./index-6WYjbOfc.js"),__vite__mapDeps([10,1,3,2,4]))),at=e.lazy(()=>ye(()=>import("./index-Cuxq7srI.js"),__vite__mapDeps([11,1,3,2,4]))),nt=e.lazy(()=>ye(()=>import("./index-8B5_arPj.js"),__vite__mapDeps([12,1,3,2,4]))),ot=e.lazy(()=>ye(()=>import("./index-CT6_89OO.js"),__vite__mapDeps([13,1,3,2,4]))),it=e.lazy(()=>ye(()=>import("./index-CR9dXD9s.js"),__vite__mapDeps([14,1,3,2,4]))),lt=e.lazy(()=>ye(()=>import("./index-CD7FmeAG.js"),__vite__mapDeps([15,1,3,2,4]))),ct=e.lazy(()=>ye(()=>import("./index-Dg8Zjgx3.js"),__vite__mapDeps([16,1,3,17,4,18,19,20,2]))),dt=e.lazy(()=>ye(()=>import("./index-BPUJ9lVA.js"),__vite__mapDeps([21,1,3,17,4,20,2,18]))),ut=e.lazy(()=>ye(()=>import("./index-BeXkyxaq.js"),__vite__mapDeps([22,1,3,4,2]))),ht=e.lazy(()=>ye(()=>import("./index-QysSuFnN.js"),__vite__mapDeps([23,1,3,2,4]))),pt=e.lazy(()=>ye(()=>import("./index-CLbvhZog.js"),__vite__mapDeps([24,1,3,2,4]))),mt=e.lazy(()=>ye(()=>import("./PostDetails-LSzROab1.js"),__vite__mapDeps([25,1,3,2,17,4,19]))),gt=e.lazy(()=>ye(()=>import("./PostsFeed-IFnYDbPD.js"),__vite__mapDeps([26,1,3,2,17,4,20]))),ft=e.lazy(()=>ye(()=>import("./index-BcT7bw60.js"),__vite__mapDeps([27,1,3,2,4]))),xt=e.lazy(()=>ye(()=>import("./index-DNZcu9jg.js"),__vite__mapDeps([28,1,3,2,4]))),wt=e.lazy(()=>ye(()=>import("./index-BdQRQdHq.js"),__vite__mapDeps([29,1,3,4,2]))),jt=e.lazy(()=>ye(()=>import("./index-glUGq1e0.js"),__vite__mapDeps([30,1,3,4,2]))),yt=e.lazy(()=>ye(()=>import("./index-B7_9-FDp.js"),__vite__mapDeps([31,3,1,4,2]))),bt=e.lazy(()=>ye(()=>import("./index-B8D6p6NW.js"),__vite__mapDeps([32,3,1,4,2]))),vt=m([{path:"/",element:J.jsx(Re,{}),errorElement:J.jsx(Ae,{}),children:[{index:!0,loader:async()=>{try{let t=null;try{const e=await fetch("/api/auth/",{headers:{"Cache-Control":"max-age=30"}});if(e.ok){const r=e.headers.get("content-type");if(r&&r.includes("application/json")){const r=await e.json();r.authenticated&&r.user&&!r.user.errors&&(t=r.user)}}}catch(e){}const r=["/api/groups","/api/events","/api/tags"].map(async t=>{try{const e=await fetch(t);return e.ok?await e.json():null}catch(e){return null}}),[s,a,n]=await Promise.all(r),o=(null==s?void 0:s.groups)||s||[],i=(null==a?void 0:a.events)||a||[];return h({allGroups:o,allEvents:i,allTags:n||[],user:t})}catch(e){return h({allGroups:[],allEvents:[],allTags:[],user:null,error:"Failed to load some data"})}},element:J.jsx(Le,{children:J.jsx(et,{})}),errorElement:J.jsx(Ae,{})},{path:"login",element:J.jsx(Le,{children:J.jsx(Xe,{})}),action:async({request:e})=>{const t=await e.formData(),r=t.get("email"),s=t.get("password"),a={};if((!r||r.length<4)&&(a.email="Email is required"),(!s||s.length<6)&&(a.password="Password must be at least 6 characters"),Object.keys(a).length>0)return h({errors:a},{status:400});try{const t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,password:s})});if(t.ok){const t=new URL(e.url).searchParams.get("from")||"/";return"undefined"!=typeof window&&(window.location.href=t),p(t)}if(t.status<500){const e=await t.json();return h({errors:e},{status:400})}return h({errors:{server:"Something went wrong. Please try again"}},{status:500})}catch(n){return h({errors:{server:"Network error. Please try again"}},{status:500})}},errorElement:J.jsx(Ae,{})},{path:"signup",element:J.jsx(Le,{children:J.jsx(Ze,{})}),action:async({request:e})=>{const t=await e.formData(),r=t.get("email"),s=t.get("username"),a=t.get("password"),n=t.get("confirmPassword"),o=t.get("firstName"),i=t.get("lastName"),l=t.get("bio"),c=t.get("profileImage"),d=t.getAll("userTags"),u={};a!==n&&(u.confirmPassword="Confirm Password field must be the same as the Password field");if(r.length>50&&(u.email="Email must be less than 50 characters"),(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)||r.length<=0)&&(u.email="Invalid email"),s.length>20&&(u.username="Username too long! Come on, who ya tryna confuse? Yourself?"),s.length<3&&(u.username="Username is too short! At least 3 characters man!"),s.length||(u.username="Now you know you need a username, I need 3 to 20 characters for you to signup!"),a.length>25&&(u.password="Password is too long!"),a.length<8&&(u.password="Password is too short!"),a.length<0&&(u.password="Password is required"),(!o.length||o.length<3||o.length>20)&&(u.firstName="First name must be between 3 and 20 characters"),(!i.length||i.length<3||i.length>20)&&(u.lastName="Last name must be between 3 and 20 characters"),(!l.length||l.length<50||l.length>500)&&(u.bio="Please enter at least 50 characters describing yourself"),c||(u.profileImage="Please add a profile image"),d.length||(u.userTags="Please select 1 or more tags that fit your description"),Object.keys(u).length>0)return h({errors:u},{status:400});try{const r=await fetch("/api/auth/signup",{method:"POST",body:t});if(r.ok){const t=await r.json(),s=new URL(e.url),a=s.searchParams.get("groupId"),n=s.searchParams.get("eventId");a&&await fetch(`/api/groups/${a}/join-group`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_id:a,user_id:t.id})}),n&&await fetch(`/api/events/${n}/attend-event`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:n,user_id:t.id})});const o=s.searchParams.get("from")||"/";return"undefined"!=typeof window&&(window.location.href=o),window.location.href=o}{const e=await r.json();return h({errors:e},{status:400})}}catch(p){return h({errors:{server:"Something went wrong. Please try again."}},{status:500})}},errorElement:J.jsx(Ae,{})},{path:"groups",loader:async({request:e})=>{try{const t=new URL(e.url).searchParams,r=t.get("page")||"1",s=t.get("per_page")||"20",a=Date.now(),n=await fetch(`/api/groups?page=${r}&per_page=${s}&_t=${a}`,{credentials:"include",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!n.ok)throw new Error(`Failed to fetch groups: ${n.status}`);const o=await n.json();let i;return i=o.groups?o:Array.isArray(o)?{groups:o}:{groups:o.groups||[]},{allGroups:i,currentPage:parseInt(r),perPage:parseInt(s)}}catch(t){return{allGroups:{groups:[]},currentPage:1,perPage:20,error:t instanceof Error?t.message:"Failed to load groups"}}},element:J.jsx(Le,{children:J.jsx(tt,{})}),errorElement:J.jsx(Ae,{})},{path:"groups/:groupId",loader:async({params:e})=>{const{groupId:t}=e;if(!t)throw new Response("Group ID is required",{status:400});try{const e=Date.now(),r=await fetch(`/api/groups/${t}?_t=${e}`,{credentials:"include",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!r.ok){if(404===r.status)throw new Response("Group not found",{status:404});throw new Error(`Failed to fetch group: ${r.status}`)}const s=await r.json();if(s.members||(s.members=[]),s.organizer&&!s.members.some(e=>e.userId===s.organizerId)){const e={id:`organizer_${s.organizerId}`,userId:s.organizerId,groupId:s.id,isOrganizer:!0,user:{id:s.organizer.id,firstName:s.organizer.firstName,lastName:s.organizer.lastName,username:s.organizer.username,email:s.organizer.email,profileImage:s.organizer.profileImage}};s.members.unshift(e)}return s}catch(r){if(r instanceof Response)throw r;throw new Response("Failed to load group",{status:500})}},element:J.jsx(Le,{children:J.jsx(rt,{})}),action:async({request:e,params:t})=>{const r=await e.formData(),s=r.get("intent"),{groupId:a}=t||{},n=r.get("id"),o=a||n;if(!o)return h({error:"Group ID is required"},{status:400});try{switch(s){case"join-group":{const e=r.get("userId");if(!e)return h({error:"User ID is required"},{status:400});const t=await fetch(`/api/groups/${o}/join-group`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_id:parseInt(o),user_id:parseInt(e)})});if(t.ok)return window.location.href=`/groups/${o}`,null;{const e=await t.json();return h({error:e.message||"Failed to join group"},{status:500})}}case"leave-group":{const e=r.get("userId"),t=r.get("memberId");if(!e)return h({error:"User ID is required"},{status:400});const s=t||e,a=await fetch(`/api/groups/${o}/leave-group/${s}`,{method:"DELETE",credentials:"include"});if(a.ok)return p("/groups");{const e=await a.json();return h({error:e.message||"Failed to leave group"},{status:500})}}case"delete-group":{const e=await fetch(`/api/groups/${o}/delete`,{method:"DELETE",credentials:"include"});if(e.ok)return window.location.href="/groups",null;{const t=await e.json();return h({error:t.message||"Failed to delete group"},{status:500})}}default:return h({error:"Invalid action"},{status:400})}}catch(i){return h({error:"Network error. Please try again"},{status:500})}},errorElement:J.jsx(Ae,{})},{path:"events",loader:async({request:e})=>{try{const t=new URL(e.url).searchParams,r=t.get("page")||"1",s=t.get("per_page")||"20",a=Date.now(),n=await fetch(`/api/events?page=${r}&per_page=${s}&_t=${a}`,{credentials:"include",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!n.ok)throw new Error(`Failed to fetch events: ${n.status}`);const o=await n.json();let i;return i=o.events?o:Array.isArray(o)?{events:o}:{events:o.events||[]},{allEvents:i,currentPage:parseInt(r),perPage:parseInt(s)}}catch(t){return{allEvents:{events:[]},currentPage:1,perPage:20,error:t instanceof Error?t.message:"Failed to load events"}}},element:J.jsx(Le,{children:J.jsx(nt,{})}),errorElement:J.jsx(Ae,{})},{path:"events/:eventId",loader:async({params:e})=>{const{eventId:t}=e;if(!t)throw new Error("Event ID is required");try{const e=Date.now(),r=await fetch(`/api/events/${t}?_t=${e}`,{credentials:"include",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!r.ok)throw new Error(`Failed to fetch event: ${r.status}`);return await r.json()}catch(r){throw r}},element:J.jsx(Le,{children:J.jsx(ot,{})}),action:async({request:e,params:t})=>{const r=await e.formData(),s=r.get("intent"),a=t.eventId||r.get("id");if(!a)return h({error:"Event ID is required"},{status:400});try{switch(s){case"attend-event":{const e=r.get("userId");if(!e)return h({error:"User ID is required"},{status:400});return(await fetch(`/api/events/${a}/attend-event`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:parseInt(a),user_id:parseInt(e)})})).ok?p(`/events/${a}`):h({error:"Failed to attend event"},{status:500})}case"leave-event":{const e=r.get("userId"),t=r.get("attendeeId");if(!e)return h({error:"User ID is required"},{status:400});const s=t||e;return(await fetch(`/api/events/${a}/leave-event/${s}`,{method:"DELETE"})).ok?p(`/events/${a}`):h({error:"Failed to leave event"},{status:500})}case"delete-event":return(await fetch(`/api/events/${a}`,{method:"DELETE"})).ok?p("/events"):h({error:"Failed to delete event"},{status:500});default:return h({error:"Invalid action"},{status:400})}}catch(n){return h({error:"Network error. Please try again"},{status:500})}},errorElement:J.jsx(Ae,{})},{path:"users/:userId",loader:async({params:e})=>{const{userId:t}=e;if(!t)throw new Response("User ID is required",{status:400});try{let e=null,s=!1;try{const r=await fetch("/api/auth/",{headers:{"Cache-Control":"max-age=30"}});if(r.ok){const a=await r.json();a.authenticated&&a.user&&(e=a.user,s=a.user.id.toString()===t)}}catch(r){}if(s)return p("/profile");const a=await fetch(`/api/users/${t}`,{headers:{"Cache-Control":"max-age=120"}});if(!a.ok){if(404===a.status)throw new Response("User not found",{status:404});throw new Response("Failed to load user profile",{status:500})}return{user:await a.json(),currentUser:e,isOwnProfile:!1,isAuthenticated:!!e}}catch(s){if(s instanceof Response)throw s;throw new Response("Failed to load user profile",{status:500})}},element:J.jsx(Le,{children:J.jsx(dt,{})}),errorElement:J.jsx(Ae,{})},{path:"profile",loader:async function({params:e}={}){const t="current-user-profile",r=(e=>{const t=Fe.get(e);return t&&Date.now()-t.timestamp<3e5?t.data:(Fe.delete(e),null)})(t);if(r)return r;try{const r=await fetch("/api/auth/profile",{method:"GET",headers:{"Content-Type":"application/json","Cache-Control":"max-age=120"}});if(!r.ok){if(401===r.status)return p("/login");throw new Error(`HTTP error! status: ${r.status}`)}const n=await r.json();if(n.errors||!n.authenticated&&!n.id)return p("/login");const o=n.user||n;if((null==e?void 0:e.id)&&o.id.toString()!==e.id)return p("/profile");const i={user:o};return s=t,a=i,Fe.set(s,{data:a,timestamp:Date.now()}),i}catch(n){return p("/login")}var s,a},element:J.jsx(Le,{children:J.jsx(ze,{children:J.jsx(ct,{})})}),action:async({request:e})=>{const t=await e.formData(),r=t.get("intent");if("add-tags"===r){const e=t.get("userId");if(!e)return h({error:"User ID is required"},{status:400});const r=t.getAll("userTags");if(0===r.length)return h({error:"Please select at least one tag"},{status:400});try{const t={userTags:r,userId:parseInt(e)},s=await fetch(`/api/users/${e}/add-tags`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(s.ok)return Ue("profile"),Ue("user"),p("/profile");{const e=await s.json();return h({error:e.message||"Failed to add tags"},{status:500})}}catch(s){return h({error:"Network error. Please try again"},{status:500})}}if("delete-profile"===r){const e=t.get("userId");if(!e)return h({error:"User ID is required"},{status:400});try{const r=await fetch(`/api/users/${e}/profile/delete`,{method:"DELETE",body:t});if(r.ok)return await fetch("/api/auth/logout",{method:"GET"}),Ue(),"undefined"!=typeof window&&(window.location.href="/"),null;{const e=await r.json();return h({error:e.message||"Failed to delete profile"},{status:500})}}catch(s){return h({error:"Network error. Please try again"},{status:500})}}return h({error:"Invalid form submission"},{status:400})},errorElement:J.jsx(Ae,{})},{path:"posts-feed",loader:async({request:e}={})=>{try{await async function(){const e=await fetch("/api/auth/",{headers:{"Cache-Control":"max-age=30"}});if(!e.ok)throw p("/login");const t=await e.json();if(!t.authenticated||!t.user)throw p("/login");return!0}();const r=e?new URL(e.url):new URL(window.location.href),s=parseInt(r.searchParams.get("page")||"1"),a=Math.min(parseInt(r.searchParams.get("per_page")||"20"),50),n=r.searchParams.get("tab")||"all";try{const e=await async function(e,t){const r=`batch-feed-${e}-${t}`,s=We(r);if(s)return s;const a=await fetch(`/api/posts/feed/batch?page=${e}&per_page=${t}`,{headers:{"Cache-Control":"max-age=60"}});if(!a.ok){const e=await a.text();throw new Error(`HTTP ${a.status}: ${e}`)}const n=await a.json(),o={allPosts:n.allPosts||[],similarPosts:n.similarPosts||[],allPostsPagination:n.allPostsPagination||{page:1,pages:0,per_page:t,total:0,has_next:!1,has_prev:!1},similarPostsPagination:n.similarPostsPagination||{page:1,pages:0,per_page:t,total:0,has_next:!1,has_prev:!1},stats:n.stats||{totalPosts:0,similarUsers:0,similarPosts:0,userTags:0},activeTab:n.activeTab||"all",message:n.message};return Be(r,o),o}(s,a);return e.activeTab=n,e}catch(t){const[e,r,o]=await Promise.allSettled([Ye("feed/all",s,a,`all-posts-${s}-${a}`),Ye("feed/similar",s,a,`similar-posts-${s}-${a}`),He()]);let i=[],l={page:1,pages:0,per_page:a,total:0,has_next:!1,has_prev:!1};"fulfilled"===e.status&&(i=e.value.posts||[],l=e.value.pagination||l);let c,d=[],u={page:1,pages:0,per_page:a,total:0,has_next:!1,has_prev:!1};"fulfilled"===r.status?(d=r.value.posts||[],u=r.value.pagination||u,c=r.value.message):c="Failed to load posts from similar users";let h={totalPosts:0,similarUsers:0,similarPosts:0,userTags:0};return"fulfilled"===o.status&&(h=o.value),{allPosts:i,similarPosts:d,allPostsPagination:l,similarPostsPagination:u,stats:h,activeTab:n,message:c}}}catch(r){if(r instanceof Response)throw r;return{allPosts:[],similarPosts:[],allPostsPagination:{page:1,pages:0,per_page:20,total:0,has_next:!1,has_prev:!1},similarPostsPagination:{page:1,pages:0,per_page:20,total:0,has_next:!1,has_prev:!1},stats:{totalPosts:0,similarUsers:0,similarPosts:0,userTags:0},activeTab:"all",error:r instanceof Error?r.message:"Failed to load posts feed"}}},element:J.jsx(Le,{children:J.jsx(ze,{children:J.jsx(gt,{})})}),action:async({request:e})=>{const t=await e.formData(),r=t.get("intent");try{switch(r){case"like-post":{const e=t.get("postId");if(!e)return h({error:"Post ID is required"},{status:400});const r=await fetch(`/api/posts/${e}/like`,{method:"POST",headers:{"Content-Type":"application/json"}});if(r.ok)return Qe("posts"),Qe("stats"),Qe("batch"),h({success:!0});{const e=await r.json();return h({error:e.message||"Failed to like post"},{status:r.status})}}case"unlike-post":{const e=t.get("postId");if(!e)return h({error:"Post ID is required"},{status:400});const r=await fetch(`/api/posts/${e}/unlike`,{method:"POST",headers:{"Content-Type":"application/json"}});if(r.ok)return Qe("posts"),Qe("stats"),Qe("batch"),h({success:!0});{const e=await r.json();return h({error:e.message||"Failed to unlike post"},{status:r.status})}}case"refresh-feed":return Qe(),h({success:!0,message:"Feed refreshed"});default:return h({error:"Invalid action"},{status:400})}}catch(s){return h({error:"Network error. Please try again"},{status:500})}}},{path:"similar-feed",loader:async({request:e}={})=>{var t;try{const r=await fetch("/api/auth/");if(!r.ok)return p("/login");if((await r.json()).errors)return p("/login");const s=e?new URL(e.url):new URL(window.location.href),a=parseInt(s.searchParams.get("page")||"1"),n=parseInt(s.searchParams.get("per_page")||"20"),o=await fetch(`/api/posts/similar-feed?page=${a}&per_page=${n}`);if(!o.ok){await o.text();throw new Error(`HTTP ${o.status}`)}const i=await o.json(),l={},c={};i.posts&&Array.isArray(i.posts)&&i.posts.forEach(e=>{if(e.user){const t=e.user.id;c[t]||(c[t]={id:e.user.id,username:e.user.username,firstName:e.user.firstName||"",lastName:e.user.lastName||"",email:"",bio:"",profileImage:e.user.profileImage,usersTags:[],createdAt:"",updatedAt:""}),l[t]||(l[t]=[]),l[t].push(e)}});return{users_profile:Object.keys(c).map(e=>{const t=parseInt(e);return{...c[t],posts:l[t]||[]}}),pagination:i.pagination,totalPosts:(null==(t=i.posts)?void 0:t.length)||0,message:i.message}}catch(r){return{users_profile:[],pagination:{page:1,pages:0,per_page:20,total:0,has_next:!1,has_prev:!1},totalPosts:0,error:`Failed to load posts: ${r instanceof Error?r.message:"Unknown error"}`}}},element:J.jsx(Le,{children:J.jsx(ze,{children:J.jsx(pt,{})})}),action:Je},{path:"profile-feed",loader:async({request:e}={})=>{try{const t=await fetch("/api/auth/",{method:"GET",headers:{"Content-Type":"application/json","Cache-Control":"max-age=30"}});if(!t.ok)return p("/login");if((await t.json()).errors)return p("/login");const r=e?new URL(e.url):new URL(window.location.href),s=parseInt(r.searchParams.get("page")||"1"),a=`/api/users/profile-feed?page=${s}&per_page=${Math.min(parseInt(r.searchParams.get("per_page")||"20"),50)}`,n=await fetch(a,{method:"GET",headers:{"Content-Type":"application/json","Cache-Control":"max-age=60"}});if(!n.ok)throw new Error("Failed to fetch profile feed");const o=await n.json();return o.users_profile?o:Array.isArray(o)?{users_profile:o}:{users_profile:[]}}catch(t){return{users_profile:[]}}},element:J.jsx(Le,{children:J.jsx(ze,{children:J.jsx(ht,{})})}),action:Je},{path:"groups/new",loader:qe,element:J.jsx(Le,{children:J.jsx(ze,{children:J.jsx(st,{})})}),action:Ge},{path:"groups/:groupId/edit",loader:async({params:e})=>{const{groupId:t}=e;if(!t)throw new Response("Group ID is required",{status:400});try{const e=await fetch("/api/auth/",{headers:{"Cache-Control":"max-age=30"}});if(!e.ok)return p("/login");const r=await e.json();if(!r.authenticated||!r.user)return p("/login");const s=Date.now(),a=await fetch(`/api/groups/${t}?_t=${s}`,{credentials:"include",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!a.ok){if(404===a.status)throw new Response("Group not found",{status:404});throw new Error(`Failed to fetch group: ${a.status}`)}const n=await a.json();if(r.user.id!==n.organizerId)throw new Response("Unauthorized - You must be the group organizer",{status:403});return{...n,user:r.user}}catch(r){if(r instanceof Response)throw r;throw new Response("Failed to load group",{status:500})}},element:J.jsx(Le,{children:J.jsx(ze,{children:J.jsx(at,{})})}),action:Ge},{path:"groups/:groupId/events/new",loader:async({params:e})=>{const{groupId:t}=e;if(!t)throw new Response("Group ID is required",{status:400});try{const e=await fetch("/api/auth/",{headers:{"Cache-Control":"max-age=30"}});if(!e.ok)return p("/login");const r=await e.json();if(!r.authenticated||!r.user)return p("/login");const s=Date.now(),a=await fetch(`/api/groups/${t}?_t=${s}`,{credentials:"include",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!a.ok){if(404===a.status)throw new Response("Group not found",{status:404});throw new Error(`Failed to fetch group: ${a.status}`)}const n=await a.json();if(r.user.id!==n.organizerId)throw new Response("Unauthorized - You must be the group organizer",{status:403});return{...n,user:r.user}}catch(r){if(r instanceof Response)throw r;throw new Response("Failed to load group",{status:500})}},element:J.jsx(Le,{children:J.jsx(ze,{children:J.jsx(it,{})})}),action:Me},{path:"groups/:groupId/events/:eventId/edit",loader:async({params:e})=>{const{groupId:t,eventId:r}=e;if(!t||!r)throw new Response("Group ID and Event ID are required",{status:400});try{const e=await fetch("/api/auth/",{headers:{"Cache-Control":"max-age=30"}});if(!e.ok)return p("/login");const s=await e.json();if(!s.authenticated||!s.user)return p("/login");const a=Date.now(),[n,o]=await Promise.all([fetch(`/api/events/${r}?_t=${a}`,{credentials:"include",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}}),fetch(`/api/groups/${t}?_t=${a}`,{credentials:"include",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}})]);if(!n.ok)return 404===n.status?p("/events?error=event-not-found"):p(`/events/${r}?error=fetch-failed`);if(!o.ok)return 404===o.status?p("/groups?error=group-not-found"):p(`/groups/${t}?error=fetch-failed`);const[i,l]=await Promise.all([n.json(),o.json()]);return s.user.id!==l.organizerId?p(`/events/${r}?error=unauthorized`):{event:i,group:l,user:s.user}}catch(s){if(s instanceof Response)throw s;return s instanceof TypeError&&s.message.includes("fetch")?p(`/events/${r}?error=network`):p(`/events/${r}?error=unknown`)}},element:J.jsx(Le,{children:J.jsx(ze,{children:J.jsx(lt,{})})}),action:Me,errorElement:J.jsx(Ae,{})},{path:"users/:userId/profile/update",loader:qe,element:J.jsx(Le,{children:J.jsx(ze,{children:J.jsx(ut,{})})}),action:async({request:e,params:t})=>{const r=await e.formData(),s=r.get("intent");if("delete-profile"===s){const e=r.get("userId");if(!e)return h({error:"User ID is required"},{status:400});try{const t=await fetch(`/api/users/${e}/profile/delete`,{method:"DELETE",body:r});if(t.ok)return await fetch("/api/auth/logout",{method:"GET"}),Ue(),"undefined"!=typeof window&&(window.location.href="/"),null;{const e=await t.json();return h({error:e.message||"Failed to delete profile"},{status:500})}}catch(g){return h({error:"Network error. Please try again"},{status:500})}}if("update-profile"!==s)return h({error:"Invalid form submission"},{status:400});const a=t.id||r.get("userId");if(!a)return h({errors:{server:"User ID is required"}},{status:400});const n={},o=r.get("firstName"),i=r.get("lastName"),l=r.get("username"),c=r.get("email"),d=r.get("password"),u=r.get("confirmPassword"),m=r.get("bio");(!o||o.length<3||o.length>20)&&(n.firstName="First name must be between 3 and 20 characters"),(!i||i.length<3||i.length>20)&&(n.lastName="Last name must be between 3 and 20 characters");c&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c)?c.length>50&&(n.email="Email must be less than 50 characters"):n.email="Please enter a valid email address",(!l||l.length<3||l.length>20)&&(n.username="Username must be between 3 and 20 characters"),d&&(d.length<8||d.length>25)&&(n.password="Password must be between 8 and 25 characters"),d!==u&&(n.confirmPassword="Passwords do not match"),(!m||m.length<50||m.length>500)&&(n.bio="Bio must be between 50 and 500 characters");if(0===r.getAll("userTags").length&&(n.userTags="Please select at least one tag"),Object.keys(n).length>0)return h({errors:n},{status:400});try{const e=await fetch(`/api/users/${a}/profile/update`,{method:"POST",body:r});if(e.ok)return Ue("profile"),Ue("user"),p("/profile");if(e.status<500){const t=await e.json();return h({errors:t},{status:400})}return h({errors:{server:"Something went wrong. Please try again"}},{status:500})}catch(g){return h({errors:{server:"Network error. Please try again"}},{status:500})}}},{path:"posts/:postId",loader:async({params:e})=>{const{postId:t}=e;if(!t)throw new Error("Post ID is required");try{const e=await fetch(`/api/posts/${t}`,{method:"GET",headers:{"Content-Type":"application/json","Cache-Control":"max-age=120"}});if(!e.ok)throw new Error("Failed to fetch post details");return await e.json()}catch(r){return p("/similar-feed")}},element:J.jsx(Le,{children:J.jsx(mt,{})}),action:Je},{path:"posts/create",loader:qe,element:J.jsx(Le,{children:J.jsx(ze,{children:J.jsx(ft,{})})}),action:Je},{path:"posts/:postId/edit",loader:qe,element:J.jsx(Le,{children:J.jsx(ze,{children:J.jsx(xt,{})})}),action:Je},{path:"partnership",element:J.jsx(Le,{children:J.jsx(wt,{})}),action:async({request:e})=>{const t=await e.formData(),r={};if("create-partnership"===t.get("intent")){const e=t.get("firstName"),a=t.get("lastName"),n=t.get("phone"),o=t.get("email"),i=t.get("subject"),l=t.get("message"),c=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if((!e||e.length<3||e.length>20)&&(r.firstName="First name must be between 3 and 20 characters"),(!a||a.length<3||a.length>20)&&(r.lastName="Last name must be between 3 and 20 characters"),!o||o.length<=0||!c.test(o)?r.email="Invalid email":o.length>50&&(r.email="Email must be less than 50 characters"),n&&isNaN(Number(n))&&(r.phone="Invalid phone number"),(!i||i.length<3||i.length>20)&&(r.subject="Subject must be between 3 and 20 characters"),(!l||l.length<10||l.length>500)&&(r.message="Please enter at least 10 characters describing yourself"),Object.keys(r).length)return h(r);try{const e=await fetch("/api/partnerships/",{method:"POST",body:t});if(!e.ok){const t=await e.json();return t.email?h({email:"Email already in use"}):h({backendError:t.message||"Something went wrong"})}return p("/success")}catch(s){return h({backendError:"Network error occurred"})}}return h({backendError:"Invalid intent"})}},{path:"contact",element:J.jsx(Le,{children:J.jsx(jt,{})}),action:async({request:e})=>{const t=await e.formData(),r={};if("create-contact"===t.get("intent")){const e=t.get("firstName"),a=t.get("lastName"),n=t.get("phone"),o=t.get("email"),i=t.get("subject"),l=t.get("message"),c=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if((!e||e.length<3||e.length>20)&&(r.firstName="First name must be between 3 and 20 characters"),(!a||a.length<3||a.length>20)&&(r.lastName="Last name must be between 3 and 20 characters"),!o||o.length<=0||!c.test(o)?r.email="Invalid email":o.length>50&&(r.email="Email must be less than 50 characters"),n&&isNaN(Number(n))&&(r.phone="Invalid phone number"),(!i||i.length<3||i.length>20)&&(r.subject="Subject must be between 3 and 20 characters"),(!l||l.length<10||l.length>500)&&(r.message="Please enter at least 10 characters describing yourself"),Object.keys(r).length)return h(r);try{const e=await fetch("/api/contact/",{method:"POST",body:t});if(e.ok)return p("/success");{const t=await e.json();return h({backendError:t.message||"Something went wrong"})}}catch(s){return h({backendError:"Network error occurred"})}}return h({backendError:"Invalid intent"})}},{path:"success",element:J.jsx(Le,{children:J.jsx(yt,{})})}]},{path:"*",element:J.jsx(Re,{children:J.jsx(Le,{children:J.jsx(bt,{})})}),errorElement:J.jsx(Ae,{})}]),Nt=ie(xe,Et,we);var Et;K.createRoot(document.getElementById("root")).render(J.jsx(r.StrictMode,{children:J.jsx(n,{store:Nt,children:J.jsx(g,{router:vt,fallbackElement:J.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 via-white to-slate-50 flex items-center justify-center",children:J.jsxs("div",{className:"text-center",children:[J.jsx("div",{className:"w-12 h-12 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),J.jsx("p",{className:"text-slate-600",children:"Loading..."})]})})})})}));export{Pe as L,Ee as O,J as j,ge as t,Ne as u};
