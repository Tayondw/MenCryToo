const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DjOjcrN4.js","assets/react-vendor-DWDxyCYt.js","assets/redux-vendor-s9F9CGgp.js","assets/router-vendor-DJrAx8OX.js","assets/ui-vendor-LOG_mfyu.js","assets/index-G5dmKjYv.js","assets/index-mhd6DGoQ.js","assets/index-DQEQ7fGT.css","assets/index-CExRMfjA.js","assets/index-fhNEmGQa.js","assets/index-CKiKcFr-.js","assets/index-CLJoKBvc.js","assets/index-o_uNkAwD.js","assets/index-UdDJUMOf.js","assets/index-SzCDafW0.js","assets/index-CK2rDTn-.js","assets/index-CL4ah_Wt.js","assets/PostMenu-Cidy_RmQ.js","assets/useLikes-BE7clvNu.js","assets/useComments-B1KC1H-F.js","assets/index-B_WezdMx.css","assets/index-uHtsNH4_.js","assets/index-mbppx2q8.js","assets/index-BAXVOCdw.css","assets/index-BM2nLjNZ.js","assets/index-D-ZbUe9_.js","assets/PostDetails-CyuKWZH_.js","assets/PostsFeed-Cbv57-xG.js","assets/index-BPPQ49AL.js","assets/index-C0ik_dvc.js","assets/index-B_ajAAxY.js","assets/index-DyLq9hE5.js","assets/index-BGlf2pXn.js","assets/index-CGR7KcV_.js"])))=>i.map(i=>d[i]);
import{r as e,b as t,c as r}from"./react-vendor-DWDxyCYt.js";import{u as s,a,P as n}from"./redux-vendor-s9F9CGgp.js";import{u as o,L as i,a as l,O as c,b as d,j as u,r as p,c as h,R as m}from"./router-vendor-DJrAx8OX.js";import{L as f,X as g,E as x,a as w,U as j,S as y,b,c as v,H as N,C as E,d as P,e as _,P as I,f as k,M as T,g as C,h as O,F as $,G as D,i as S,j as R,k as z,A as L,l as A}from"./ui-vendor-LOG_mfyu.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var q={exports:{}},F={},U=e,G=Symbol.for("react.element"),M=Symbol.for("react.fragment"),V=Object.prototype.hasOwnProperty,W=U.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,B={key:!0,ref:!0,__self:!0,__source:!0};function H(e,t,r){var s,a={},n=null,o=null;for(s in void 0!==r&&(n=""+r),void 0!==t.key&&(n=""+t.key),void 0!==t.ref&&(o=t.ref),t)V.call(t,s)&&!B.hasOwnProperty(s)&&(a[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===a[s]&&(a[s]=t[s]);return{$$typeof:G,type:e,key:n,ref:o,props:a,_owner:W.current}}F.Fragment=M,F.jsx=H,F.jsxs=H,q.exports=F;var Y=q.exports,J={},K=t;function Q(e){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e){var t=function(e,t){if("object"!=Q(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t);if("object"!=Q(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Q(t)?t:t+""}function Z(e,t,r){return(t=X(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(r),!0).forEach(function(t){Z(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function re(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}J.createRoot=K.createRoot,J.hydrateRoot=K.hydrateRoot;var se="function"==typeof Symbol&&Symbol.observable||"@@observable",ae=function(){return Math.random().toString(36).substring(7).split("").join(".")},ne={INIT:"@@redux/INIT"+ae(),REPLACE:"@@redux/REPLACE"+ae(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+ae()}};var oe=function e(t,r,s){var a;if("function"==typeof r&&"function"==typeof s||"function"==typeof s&&"function"==typeof arguments[3])throw new Error(re(0));if("function"==typeof r&&void 0===s&&(s=r,r=void 0),void 0!==s){if("function"!=typeof s)throw new Error(re(1));return s(e)(t,r)}if("function"!=typeof t)throw new Error(re(2));var n=t,o=r,i=[],l=i,c=!1;function d(){l===i&&(l=i.slice())}function u(){if(c)throw new Error(re(3));return o}function p(e){if("function"!=typeof e)throw new Error(re(4));if(c)throw new Error(re(5));var t=!0;return d(),l.push(e),function(){if(t){if(c)throw new Error(re(6));t=!1,d();var r=l.indexOf(e);l.splice(r,1),i=null}}}function h(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error(re(7));if(void 0===e.type)throw new Error(re(8));if(c)throw new Error(re(9));try{c=!0,o=n(o,e)}finally{c=!1}for(var t=i=l,r=0;r<t.length;r++){(0,t[r])()}return e}return h({type:ne.INIT}),(a={dispatch:h,subscribe:p,getState:u,replaceReducer:function(e){if("function"!=typeof e)throw new Error(re(10));n=e,h({type:ne.REPLACE})}})[se]=function(){var e,t=p;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(re(11));function r(){e.next&&e.next(u())}return r(),{unsubscribe:t(r)}}})[se]=function(){return this},e},a};function ie(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function le(e){return function(t){var r=t.dispatch,s=t.getState;return function(t){return function(a){return"function"==typeof a?a(r,s,e):t(a)}}}}var ce=le();ce.withExtraArgument=le;const de="session/setUser",ue="session/removeUser",pe=e=>({type:de,payload:e}),he=()=>({type:ue}),me=e=>async t=>{try{const s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok){const e=await s.json();try{const e=await fetch("/api/auth/");if(e.ok){const r=await e.json();if(r.authenticated&&r.user)return t(pe(r.user)),null;if(!r.errors)return t(pe(r)),null}}catch(r){}return t(pe(e)),null}if(s.status<500){return await s.json()}return{server:"Something went wrong. Please try again"}}catch(s){return{server:"Network error occurred"}}},fe={user:null};const ge=function(e){for(var t=Object.keys(e),r={},s=0;s<t.length;s++){var a=t[s];"function"==typeof e[a]&&(r[a]=e[a])}var n,o=Object.keys(r);try{!function(e){Object.keys(e).forEach(function(t){var r=e[t];if(void 0===r(void 0,{type:ne.INIT}))throw new Error(re(12));if(void 0===r(void 0,{type:ne.PROBE_UNKNOWN_ACTION()}))throw new Error(re(13))})}(r)}catch(i){n=i}return function(e,t){if(void 0===e&&(e={}),n)throw n;for(var s=!1,a={},i=0;i<o.length;i++){var l=o[i],c=r[l],d=e[l],u=c(d,t);if(void 0===u)throw t&&t.type,new Error(re(14));a[l]=u,s=s||u!==d}return(s=s||o.length!==Object.keys(e).length)?a:e}}({session:function(e=fe,t){switch(t.type){case de:return{...e,user:t.payload};case ue:return{...e,user:null};default:return e}}});let xe;xe=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),s=function(){throw new Error(re(15))},a={getState:r.getState,dispatch:function(){return s.apply(void 0,arguments)}},n=t.map(function(e){return e(a)});return s=ie.apply(void 0,n)(r.dispatch),te(te({},r),{},{dispatch:s})}}}(ce);const we={},je=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),r=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));s=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in we)return;we[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":"modulepreload",t||(a.as="script"),a.crossOrigin="",a.href=e,r&&a.setAttribute("nonce",r),document.head.appendChild(a),t?new Promise((t,r)=>{a.addEventListener("load",t),a.addEventListener("error",()=>r(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return s.then(t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)})},ye=e.createContext(void 0),be=({children:t})=>{const[r,s]=e.useState(null),a=()=>{s(null)};return Y.jsxs(ye.Provider,{value:{modalContent:r,setModalContent:s,closeModal:a},children:[t,r&&Y.jsxs("div",{id:"modal",children:[Y.jsx("div",{id:"modal-background",onClick:a}),Y.jsx("div",{id:"modal-content",children:r})]})]})},ve=()=>{const t=e.useContext(ye);if(!t)throw new Error("useModal must be used within a ModalProvider");return t},Ne=({itemText:e,onItemClick:t,modalComponent:r,className:s=""})=>{const{setModalContent:a}=ve();return Y.jsx("span",{onClick:()=>{t&&t(),a(r)},className:s,children:e})},Ee=({navigate:t})=>{const r=s(),a=o(),{closeModal:n}=ve(),[i,l]=e.useState(""),[c,d]=e.useState(""),[u,p]=e.useState({}),[h,m]=e.useState(!1),[y,b]=e.useState(!1),v=i.length<4||c.length<6,N=t||a,E=()=>{n()};return e.useEffect(()=>{const e=()=>{E()};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)}),Y.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md transform transition-all duration-300 scale-100 animate-in fade-in-0 zoom-in-95 mx-4",children:[Y.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[Y.jsxs("div",{className:"flex items-center gap-3",children:[Y.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-orange-400 to-orange-600 rounded-full flex items-center justify-center",children:Y.jsx(f,{size:20,className:"text-white"})}),Y.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Welcome Back"})]}),Y.jsx("button",{onClick:E,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-slate-100 transition-colors",children:Y.jsx(g,{size:20,className:"text-slate-500"})})]}),Y.jsxs("form",{onSubmit:async e=>{e.preventDefault(),b(!0),p({});try{const e=await r(me({email:i,password:c}));e?p(e):(E(),N("/"))}catch{p({server:"Something went wrong. Please try again."})}finally{b(!1)}},className:"p-6 space-y-6",children:[u.server&&Y.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm font-medium",children:u.server}),Y.jsxs("div",{className:"space-y-2",children:[Y.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold text-slate-700",children:"Email Address"}),Y.jsx("input",{id:"email",type:"email",value:i,onChange:e=>l(e.target.value),placeholder:"Enter your email",className:`w-full px-4 py-3 border-2 rounded-xl transition-all duration-200 ${u.email?"border-red-300 focus:border-red-500 focus:ring-red-200":"border-slate-200 focus:border-orange-400 focus:ring-orange-100"} focus:outline-none focus:ring-4`,required:!0}),u.email&&Y.jsx("p",{className:"text-red-600 text-sm font-medium",children:u.email})]}),Y.jsxs("div",{className:"space-y-2",children:[Y.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-slate-700",children:"Password"}),Y.jsxs("div",{className:"relative",children:[Y.jsx("input",{id:"password",type:h?"text":"password",value:c,onChange:e=>d(e.target.value),placeholder:"Enter your password",className:`w-full px-4 py-3 pr-12 border-2 rounded-xl transition-all duration-200 ${u.password?"border-red-300 focus:border-red-500 focus:ring-red-200":"border-slate-200 focus:border-orange-400 focus:ring-orange-100"} focus:outline-none focus:ring-4`,required:!0}),Y.jsx("button",{type:"button",onClick:()=>m(!h),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors",children:h?Y.jsx(x,{size:20}):Y.jsx(w,{size:20})})]}),u.password&&Y.jsx("p",{className:"text-red-600 text-sm font-medium",children:u.password})]}),Y.jsxs("div",{className:"space-y-3",children:[Y.jsx("button",{type:"submit",disabled:v||y,className:"w-full py-3 px-4 rounded-xl font-semibold text-white transition-all duration-200 "+(v||y?"bg-slate-300 cursor-not-allowed":"bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 hover:shadow-lg hover:-translate-y-0.5 active:translate-y-0"),children:y?Y.jsxs("div",{className:"flex items-center justify-center gap-2",children:[Y.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Signing In..."]}):"Log In"}),Y.jsxs("button",{type:"button",onClick:async e=>{e.preventDefault(),b(!0),p({});try{const e=await r(me({email:"demo@aa.io",password:"password"}));e?p(e):(E(),N("/"))}catch{p({server:"Something went wrong. Please try again."})}finally{b(!1)}},disabled:y,className:"w-full py-3 px-4 rounded-xl font-semibold text-slate-700 bg-slate-100 hover:bg-slate-200 transition-all duration-200 hover:shadow-md hover:-translate-y-0.5 active:translate-y-0 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[Y.jsx(j,{size:18}),"Try Demo Account"]})]})]}),Y.jsx("div",{className:"px-6 pb-6 text-center",children:Y.jsxs("p",{className:"text-sm text-slate-600",children:["Don't have an account?"," ",Y.jsx("button",{onClick:()=>{E(),N("/signup")},className:"text-orange-600 hover:text-orange-700 font-semibold transition-colors",children:"Sign up here"})]})})]})},Pe=({className:e="",size:t="md"})=>Y.jsx("div",{className:`${{sm:"w-8 h-8",md:"w-10 h-10",lg:"w-12 h-12"}[t]} ${e} relative`,children:Y.jsxs("svg",{viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-full h-full",children:[Y.jsxs("defs",{children:[Y.jsxs("linearGradient",{id:"logoGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[Y.jsx("stop",{offset:"0%",stopColor:"#f59e0b"}),Y.jsx("stop",{offset:"100%",stopColor:"#d97706"})]}),Y.jsxs("linearGradient",{id:"heartGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[Y.jsx("stop",{offset:"0%",stopColor:"#ffffff"}),Y.jsx("stop",{offset:"100%",stopColor:"#f8fafc"})]}),Y.jsx("filter",{id:"dropShadow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:Y.jsx("feDropShadow",{dx:"0",dy:"2",stdDeviation:"2",floodColor:"#000000",floodOpacity:"0.1"})})]}),Y.jsx("circle",{cx:"20",cy:"20",r:"18",fill:"url(#logoGradient)",filter:"url(#dropShadow)",className:"drop-shadow-lg"}),Y.jsx("circle",{cx:"20",cy:"20",r:"15",fill:"none",stroke:"rgba(255,255,255,0.2)",strokeWidth:"0.5"}),Y.jsx("path",{d:"M20 28c-1.5-1.2-6-4.8-6-9 0-2.2 1.8-4 4-4 1.1 0 2.1.4 2.8 1.2.7-.8 1.7-1.2 2.8-1.2 2.2 0 4 1.8 4 4 0 4.2-4.5 7.8-6 9z",fill:"url(#heartGradient)",className:"drop-shadow-sm"}),Y.jsx("ellipse",{cx:"26",cy:"14",rx:"1.5",ry:"2.5",fill:"rgba(255,255,255,0.9)",className:"animate-pulse",style:{animationDuration:"3s",animationDelay:"1s"}}),Y.jsx("path",{d:"M12 22c-1 0-2 .5-2 1.5s1 1.5 2 1.5h2v-3h-2z",fill:"rgba(255,255,255,0.8)"}),Y.jsx("path",{d:"M28 22c1 0 2 .5 2 1.5s-1 1.5-2 1.5h-2v-3h2z",fill:"rgba(255,255,255,0.8)"}),Y.jsx("path",{d:"M16 12v4l2-2 2 2v-4",stroke:"rgba(255,255,255,0.6)",strokeWidth:"1",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})]})}),_e=e.memo(({to:e,icon:t,label:r,onClick:s,className:a="",isActive:n=!1})=>{const o="flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200",l=n?"bg-orange-100 text-orange-700 shadow-sm":"text-slate-600 hover:text-slate-900 hover:bg-slate-100";return e?Y.jsxs(i,{to:e,onClick:s,className:`${o} ${l} ${a}`,children:[Y.jsx(t,{size:18}),Y.jsx("span",{children:r})]}):Y.jsxs("button",{onClick:s,className:`${o} ${l} w-full text-left ${a}`,children:[Y.jsx(t,{size:18}),Y.jsx("span",{children:r})]})});_e.displayName="NavigationItem";const Ie=e.memo(({src:t,alt:r,className:s,fallbackSrc:a="/default-avatar.png"})=>{const[n,o]=e.useState(t),[i,l]=e.useState(!1);e.useEffect(()=>{o(t),l(!1)},[t]);const c=e.useCallback(()=>{i||n===a||(l(!0),o(a))},[n,i,a]);return Y.jsx("img",{src:n,alt:r,className:s,onError:c})});Ie.displayName="ProfileImage";const ke=e.memo(({user:e,onLogout:t,onCloseMenu:r,isMobile:s=!1})=>s?Y.jsxs("div",{className:"pt-4 border-t border-slate-200 space-y-2",children:[Y.jsxs("div",{className:"flex items-center space-x-3 px-4 py-3",children:[Y.jsx(Ie,{src:e.profileImage,alt:e.username,className:"w-12 h-12 rounded-full object-cover border-2 border-slate-200"}),Y.jsxs("div",{children:[Y.jsxs("p",{className:"font-semibold text-slate-900",children:[e.firstName," ",e.lastName]}),Y.jsxs("p",{className:"text-sm text-slate-500",children:["@",e.username]})]})]}),Y.jsx(_e,{to:"/profile",icon:j,label:"View Profile",onClick:r,className:"text-slate-700 hover:bg-slate-100"}),Y.jsx(_e,{to:`/users/${e.id}/profile/update`,icon:y,label:"Settings",onClick:r,className:"text-slate-700 hover:bg-slate-100"}),Y.jsx(_e,{icon:b,label:"Sign Out",onClick:()=>{t(),r()},className:"text-red-600 hover:bg-red-50 hover:text-red-700"})]}):Y.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-xl shadow-xl border border-slate-200 py-2 z-50 animate-in fade-in-0 zoom-in-95 duration-200",children:[Y.jsx("div",{className:"px-4 py-3 border-b border-slate-100",children:Y.jsxs("div",{className:"flex items-center space-x-3",children:[Y.jsx(Ie,{src:e.profileImage,alt:e.username,className:"w-12 h-12 rounded-full object-cover"}),Y.jsxs("div",{children:[Y.jsxs("p",{className:"font-semibold text-slate-900",children:[e.firstName," ",e.lastName]}),Y.jsx("p",{className:"text-sm text-slate-500",children:e.email})]})]})}),Y.jsxs("div",{className:"py-2",children:[Y.jsx(_e,{to:"/profile",icon:j,label:"View Profile",onClick:r,className:"text-slate-700 hover:bg-slate-50"}),Y.jsx(_e,{to:`/users/${e.id}/profile/update`,icon:y,label:"Settings",onClick:r,className:"text-slate-700 hover:bg-slate-50"}),Y.jsx(_e,{to:"/profile-feed",icon:v,label:"Similar to You",onClick:r,className:"text-slate-700 hover:bg-slate-50"})]}),Y.jsx("div",{className:"border-t border-slate-100 pt-2",children:Y.jsx(_e,{icon:b,label:"Sign Out",onClick:()=>{t(),r()},className:"text-red-600 hover:bg-red-50 hover:text-red-700 w-full text-left"})})]}));ke.displayName="UserMenu";const Te=e.memo(()=>{const t=a(e=>e.session.user),r=(n=t)?"object"==typeof n&&"user"in n&&"authenticated"in n&&n.user&&n.authenticated?n.user:"object"==typeof n&&"id"in n&&"username"in n&&"number"==typeof n.id&&"string"==typeof n.username?n:null:null;var n;const c=s(),d=o(),u=l(),[p,h]=e.useState(!1),[m,f]=e.useState(!1),[x,w]=e.useState(!1),j=e.useRef(null),y=e.useRef(null),b=e.useMemo(()=>r?[{path:"/",label:"Home",icon:N},{path:"/groups",label:"Groups",icon:v},{path:"/events",label:"Events",icon:E},{path:"/posts-feed",label:"Feed",icon:P},{path:"/profile-feed",label:"Similar To You",icon:_},{path:"/posts/create",label:"Share Story",icon:I}]:[{path:"/",label:"Home",icon:N},{path:"/groups",label:"Groups",icon:v},{path:"/events",label:"Events",icon:E}],[r]),C=e.useCallback(async()=>{try{await c(async e=>{try{await fetch("/api/auth/logout"),e(he()),"undefined"!=typeof window&&(window.sessionStorage.clear(),window.localStorage.removeItem("userPreferences"))}catch(t){e(he())}}),f(!1),d("/",{replace:!0})}catch(e){}},[c,d]),O=e.useCallback(()=>{h(e=>!e),f(!1)},[]),$=e.useCallback(()=>{f(e=>!e),h(!1)},[]),D=e.useCallback(()=>{h(!1)},[]),S=e.useCallback(()=>{f(!1)},[]),R=e.useCallback(e=>u.pathname===e,[u.pathname]);return e.useEffect(()=>{const e=()=>{w(window.scrollY>10)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),e.useEffect(()=>{const e=e=>{j.current&&!j.current.contains(e.target)&&f(!1),y.current&&!y.current.contains(e.target)&&h(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),e.useEffect(()=>{h(!1),f(!1)},[u.pathname]),Y.jsxs(Y.Fragment,{children:[Y.jsxs("nav",{className:"fixed top-0 left-0 right-0 z-50 transition-all duration-300 "+(x?"bg-white/95 backdrop-blur-md shadow-lg border-b border-slate-200/50":"bg-white/90 backdrop-blur-sm"),children:[Y.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:Y.jsxs("div",{className:"flex items-center justify-between h-16 lg:h-20",children:[Y.jsxs(i,{to:"/",className:"flex items-center space-x-3 group",children:[Y.jsx(Pe,{size:"md",className:"group-hover:scale-105 transition-transform duration-300 drop-shadow-lg group-hover:drop-shadow-xl"}),Y.jsx("div",{className:"hidden sm:block",children:Y.jsx("h1",{className:"text-xl lg:text-2xl mb-0 font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"MEN CRY TOO"})})]}),Y.jsx("div",{className:"hidden lg:flex items-center space-x-1",children:b.map(({path:e,label:t,icon:r})=>Y.jsx(_e,{to:e,icon:r,label:t,isActive:R(e)},e))}),Y.jsxs("div",{className:"flex items-center space-x-3",children:[r?Y.jsxs("div",{className:"relative",ref:j,children:[Y.jsxs("button",{onClick:$,className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-slate-100 transition-all duration-200 group",children:[Y.jsxs("div",{className:"relative",children:[Y.jsx(Ie,{src:r.profileImage,alt:r.username,className:"w-8 h-8 lg:w-10 lg:h-10 rounded-full object-cover border-2 border-slate-200 group-hover:border-orange-300 transition-all duration-200"}),Y.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 border-2 border-white rounded-full"})]}),Y.jsxs("div",{className:"hidden lg:block text-left",children:[Y.jsx("p",{className:"text-sm font-semibold text-slate-900",children:r.firstName}),Y.jsxs("p",{className:"text-xs text-slate-500",children:["@",r.username]})]}),Y.jsx(k,{size:16,className:"hidden lg:block text-slate-400 transition-transform duration-200 "+(m?"rotate-180":"")})]}),m&&Y.jsx(ke,{user:r,onLogout:C,onCloseMenu:S})]}):Y.jsxs("div",{className:"hidden lg:flex items-center space-x-3",children:[Y.jsx(Ne,{itemText:"Sign In",modalComponent:Y.jsx(Ee,{}),className:"px-4 py-2 text-slate-600 hover:text-slate-900 font-medium transition-colors duration-200 cursor-pointer"}),Y.jsx(i,{to:"/signup",className:"px-6 py-2 bg-gradient-to-r from-orange-500 to-orange-600 text-white font-semibold rounded-lg hover:from-orange-600 hover:to-orange-700 transition-all duration-200 hover:shadow-lg hover:-translate-y-0.5",children:"Sign Up"})]}),Y.jsx("button",{onClick:O,className:"lg:hidden flex items-center justify-center w-10 h-10 rounded-lg text-slate-600 hover:text-slate-900 hover:bg-slate-100 transition-all duration-200","aria-label":"Toggle mobile menu",children:p?Y.jsx(g,{size:24}):Y.jsx(T,{size:24})})]})]})}),p&&Y.jsx("div",{ref:y,className:"lg:hidden bg-white border-t border-slate-200 shadow-lg animate-in slide-in-from-top-2 duration-200",children:Y.jsxs("div",{className:"px-4 py-4 space-y-2",children:[b.map(({path:e,label:t,icon:r})=>Y.jsx(_e,{to:e,icon:r,label:t,onClick:D,isActive:R(e),className:R(e)?"bg-orange-100 text-orange-700":"text-slate-600 hover:text-slate-900 hover:bg-slate-100"},e)),!r&&Y.jsxs("div",{className:"pt-4 border-t border-slate-200 space-y-3",children:[Y.jsx(Ne,{itemText:"Sign In",modalComponent:Y.jsx(Ee,{}),className:"flex items-center justify-center w-full px-4 py-3 text-slate-600 hover:text-slate-900 font-medium border border-slate-300 rounded-lg hover:bg-slate-50 transition-all duration-200 cursor-pointer"}),Y.jsx(i,{to:"/signup",className:"flex items-center justify-center w-full px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white font-semibold rounded-lg hover:from-orange-600 hover:to-orange-700 transition-all duration-200",onClick:D,children:"Sign Up"})]}),r&&Y.jsx(ke,{user:r,onLogout:C,onCloseMenu:D,isMobile:!0})]})})]}),Y.jsx("div",{className:"h-16 lg:h-20"})]})});Te.displayName="Navigation";const Ce=()=>{const e=(new Date).getFullYear(),t=[{name:"Portfolio",href:"https://github.com/Tayondw/Tayondw",icon:$,color:"hover:text-purple-400",description:"View my portfolio"},{name:"GitHub",href:"https://github.com/Tayondw",icon:D,color:"hover:text-gray-300",description:"Check out my code"},{name:"LinkedIn",href:"https://www.linkedin.com/in/tayon",icon:S,color:"hover:text-blue-400",description:"Connect with me professionally"},{name:"Resume",href:"/assets/Williams-Tayon-SWE.pdf",icon:R,color:"hover:text-green-400",description:"Download my resume",download:!0}];return Y.jsxs("footer",{className:"bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-white",children:[Y.jsx("div",{className:"flex mx-auto px-4 sm:px-6 lg:px-8 py-6 justify-around",children:Y.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8 items-center",children:[Y.jsxs("div",{className:"lg:col-span-1 text-center lg:text-left",children:[Y.jsxs("div",{className:"flex items-center gap-2 justify-center lg:justify-start mb-4",children:[Y.jsx(C,{size:24,className:"text-orange-400"}),Y.jsx("h3",{className:"text-xl font-bold text-orange-400",children:"MEET THE DEVELOPER"})]}),Y.jsx("h4",{className:"text-2xl font-semibold text-white mb-2 text-center",children:"Tayon Williams"}),Y.jsxs("div",{className:"flex items-center gap-2 justify-center lg:justify-center text-slate-300 ",children:[Y.jsx(O,{size:16}),Y.jsx("a",{href:"mailto:tayondw@gmail.com",className:"hover:text-orange-400 transition-colors duration-200",children:"tayondw@gmail.com"})]}),Y.jsx("p",{className:"text-slate-400 text-sm mt-2 text-center",children:"Full Stack Software Engineer"})]}),Y.jsx("div",{className:"lg:col-span-1 flex justify-center",children:Y.jsxs("div",{className:"relative group",children:[Y.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-orange-400 to-blue-500 rounded-full blur opacity-25 group-hover:opacity-75 transition duration-300"}),Y.jsx("img",{src:"https://mencrytoo.s3.amazonaws.com/Proffesional-headshot-1.jpg",alt:"Tayon Williams - Professional Headshot",className:"relative w-32 h-32 lg:w-40 lg:h-40 rounded-full object-cover border-4 border-slate-700 group-hover:border-orange-400 transition-all duration-300 shadow-xl"}),Y.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})}),Y.jsxs("div",{className:"lg:col-span-1",children:[Y.jsx("h4",{className:"text-lg font-semibold items-center lg:text-center text-slate-200",children:"Connect With Me"}),Y.jsx("div",{className:"grid grid-cols-2 gap-4 justify-self-center",children:t.map(e=>{const t=e.icon;return Y.jsx("div",{className:"group",children:e.download?Y.jsxs("a",{href:e.href,download:"Williams-Tayon-SWE.pdf",className:`flex items-center gap-3 p-3 rounded-lg bg-slate-800/50 hover:bg-slate-700/50 transition-all duration-200 ${e.color} group-hover:transform group-hover:scale-105`,title:e.description,children:[Y.jsx(t,{size:20}),Y.jsx("span",{className:"font-medium",children:e.name}),Y.jsx(z,{size:14,className:"ml-auto opacity-0 group-hover:opacity-100 transition-opacity"})]}):Y.jsxs(i,{to:e.href,target:"_blank",rel:"noopener noreferrer",className:`flex items-center gap-3 p-3 rounded-lg bg-slate-800/50 hover:bg-slate-700/50 transition-all duration-200 ${e.color} group-hover:transform group-hover:scale-105`,title:e.description,children:[Y.jsx(t,{size:20}),Y.jsx("span",{className:"font-medium",children:e.name}),Y.jsx(z,{size:14,className:"ml-auto opacity-0 group-hover:opacity-100 transition-opacity"})]})},e.name)})})]}),Y.jsxs("div",{className:"lg:col-span-1 text-center lg:text-center",children:[Y.jsx("h4",{className:"text-lg font-semibold mb-4 text-slate-200",children:"About This Project"}),Y.jsxs("div",{className:"space-y-3 justify-self-center",children:[Y.jsxs("div",{className:"flex items-center gap-2 justify-center lg:justify-start text-slate-300",children:[Y.jsx(_,{size:16,className:"text-red-400"}),Y.jsx("span",{className:"text-sm",children:"Built with passion for mental health"})]}),Y.jsxs("div",{className:"flex items-center gap-2 justify-center lg:justify-start text-slate-300",children:[Y.jsx(C,{size:16,className:"text-blue-400"}),Y.jsx("span",{className:"text-sm",children:"React • JavaScript • TypeScript • Tailwind • Python"})]}),Y.jsxs("div",{className:"flex items-center gap-2 justify-center lg:justify-start text-slate-300",children:[Y.jsx(j,{size:16,className:"text-green-400"}),Y.jsx("span",{className:"text-sm",children:"Supporting men's mental wellness"})]})]})]})]})}),Y.jsx("div",{className:"border-t border-slate-700",children:Y.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:Y.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[Y.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[Y.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-orange-400 to-blue-500 bg-clip-text text-transparent",children:"MEN CRY TOO"}),Y.jsxs("span",{className:"text-sm",children:["© ",e," All rights reserved"]})]}),Y.jsx("div",{className:"text-center md:text-right",children:Y.jsx("p",{className:"text-slate-400 text-sm italic",children:'"It\'s okay to cry" - Breaking stigma, building community'})})]})})})]})},Oe=()=>{const{pathname:t}=l();return e.useEffect(()=>{window.scrollTo(0,0)},[t]),null},$e=e.memo(({children:t})=>{const r=s(),[a,n]=e.useState(!1);return e.useEffect(()=>{(async()=>{try{await r(async e=>{try{const t=await fetch("/api/auth/");if(t.ok){const r=await t.json();return r.errors?(e(he()),null):r.authenticated&&r.user?(e(pe(r.user)),r.user):r.id&&r.username?(e(pe(r)),r):(e(he()),null)}return e(he()),null}catch(t){return e(he()),null}})}catch(e){}finally{n(!0)}})()},[r]),a?Y.jsxs(be,{children:[Y.jsx(Te,{}),Y.jsx(Oe,{}),Y.jsxs("div",{className:"relative overflow-hidden",children:[Y.jsx("main",{className:"relative",children:t||Y.jsx(c,{})}),Y.jsx("div",{className:"clear-both h-0"}),Y.jsx("div",{className:"absolute bottom-0 left-0 w-full h-1 bg-gradient-to-r from-orange-400 via-blue-500 to-purple-500"})]}),Y.jsx(Ce,{})]}):Y.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 via-white to-slate-50 flex items-center justify-center",children:Y.jsxs("div",{className:"text-center",children:[Y.jsx("div",{className:"w-12 h-12 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),Y.jsx("p",{className:"text-slate-600 text-sm",children:"Loading application..."})]})})});$e.displayName="Layout";const De=({children:e})=>a(e=>e.session.user)?Y.jsx(Y.Fragment,{children:e}):(window.location.href="/",null),Se=()=>Y.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 via-white to-slate-50 flex items-center justify-center",children:Y.jsxs("div",{className:"text-center p-8",children:[Y.jsx("div",{className:"w-16 h-16 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),Y.jsx("p",{className:"text-slate-600",children:"Loading..."})]})}),Re=({children:t})=>Y.jsx(e.Suspense,{fallback:Y.jsx(Se,{}),children:t}),ze=()=>{const e=d(),t=(()=>{if(e.data&&"object"==typeof e.data&&null!==e.data){const t=e.data;return"errors"in t&&t.errors,t}return null})(),{title:r,message:s,status:a}=(()=>{if(!e)return{title:"Unknown Error",message:"Something went wrong.",status:500};if(404===e.status)return{title:"Page Not Found",message:"The page you're looking for doesn't exist.",status:404};if(403===e.status)return{title:"Access Denied",message:"You don't have permission to access this page.",status:403};if(401===e.status)return{title:"Authentication Required",message:"Please log in to access this page.",status:401};let r=e.message||e.statusText||"An unexpected error occurred.";if(t&&"errors"in t){const e=t.errors;"object"==typeof e&&null!==e&&"message"in e&&(r=String(e.message))}return{title:"Something Went Wrong",message:r,status:e.status||500}})();return Y.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-orange-50 to-slate-100 flex items-center justify-center p-4",children:Y.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-lg border border-slate-200 p-8 text-center",children:[Y.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:Y.jsx(L,{size:32,className:"text-red-600"})}),Y.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:r}),Y.jsx("p",{className:"text-slate-600 mb-6",children:s}),Y.jsxs("div",{className:"text-sm text-slate-500 mb-6",children:["Error Code: ",a]}),Y.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[Y.jsxs("button",{onClick:()=>window.history.back(),className:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:[Y.jsx(A,{size:16}),"Go Back"]}),Y.jsxs(i,{to:"/",className:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors",children:[Y.jsx(N,{size:16}),"Home"]})]}),!1]})})},Le=async()=>{try{const e=await fetch("/api/auth/",{headers:{"Cache-Control":"max-age=30"}});if(!e.ok)return p("/login");const t=e.headers.get("content-type");if(!t||!t.includes("application/json"))return p("/login");const r=await e.json();return r.authenticated&&r.user?{user:r.user}:p("/login")}catch(e){return p("/login")}},Ae=new Map;function qe(e){if(e)for(const t of Ae.keys())t.includes(e)&&Ae.delete(t);else Ae.clear()}const Fe=async({request:e})=>{var t;const r=await e.formData(),s=r.get("intent"),a={};if("create-group"===s||"edit-group"===s){const e=r.get("name"),t=r.get("about"),n=r.get("type"),o=r.get("city"),i=r.get("state"),l=r.get("image");if((!e||e.length<3||e.length>50)&&(a.name="Group name must be between 3 and 50 characters"),(!t||t.length<20||t.length>150)&&(a.about="Description must be at least 20 characters and no more than 150 characters"),n||(a.type="Group Type is required"),(!o||o.length<3||o.length>30)&&(a.city="City name must be between 3 and 30 characters"),i&&2===i.length||(a.state="Please enter the abbreviated form of the state"),"create-group"!==s||l||(a.image="Group image is required to create a group"),Object.keys(a).length>0)return u({errors:a},{status:400})}try{switch(s){case"create-group":{const e=await fetch("/api/groups/new",{method:"POST",credentials:"include",body:r});if(e.ok){const r=await e.json();return(null==(t=r.group)?void 0:t.id)?(window.location.href=`/groups/${r.group.id}`,null):(window.location.href="/groups",null)}{const t=await e.json();return u({errors:t.errors||t},{status:400})}}case"edit-group":{const e=r.get("id");if(!e)return u({errors:{server:"Group ID is required"}},{status:400});const t=await fetch(`/api/groups/${e}/edit`,{method:"POST",credentials:"include",body:r});if(t.ok)return window.location.href=`/groups/${e}`,null;{const e=await t.json();return u({errors:e.errors||e},{status:400})}}default:return u({errors:{server:"Invalid form submission"}},{status:400})}}catch(n){return u({errors:{server:"Network error. Please try again"}},{status:500})}},Ue=async({request:e})=>{const t=await e.formData(),r=t.get("intent"),s={};if("create-event"===r||"edit-event"===r){const e=t.get("name"),a=t.get("description"),n=t.get("type"),o=t.get("capacity"),i=t.get("startDate"),l=t.get("endDate"),c=t.get("image");(!e||e.length<5||e.length>50)&&(s.name="Event name must be between 5 and 50 characters"),(!a||a.length<50||a.length>150)&&(s.description="Description must be at least 50 characters and no more than 150 characters"),n||(s.type="Event Type is required"),(!o||parseInt(o)<2||parseInt(o)>300)&&(s.capacity="Event capacity must have at least two people attending and cannot exceed more than 300 people");const d=new Date,p=new Date(i),h=new Date(l);if(!i||isNaN(p.getTime())?s.startDate="Invalid start date":p<d&&(s.startDate="Start date must be after or on the current date"),!l||isNaN(h.getTime())?s.endDate="Invalid end date":h<p&&(s.endDate="End date must be after the start date"),"create-event"!==r||c||(s.image="Event image is required to create an event"),Object.keys(s).length>0)return u({errors:s},{status:400})}try{switch(r){case"create-event":{const e=t.get("group_id");if(!e)return u({errors:{server:"Group ID is required"}},{status:400});const r=await fetch(`/api/groups/${e}/events/new`,{method:"POST",credentials:"include",body:t});if(r.ok){const e=Date.now();return"undefined"!=typeof window?(window.location.href=`/events?refresh=${e}`,null):p(`/events?refresh=${e}`)}{const e=await r.json();return u({errors:e},{status:400})}}case"edit-event":{const e=t.get("eventId"),r=t.get("group_id");if(!e||!r)return u({errors:{server:"Event ID and Group ID are required"}},{status:400});const s=await fetch(`/api/groups/${r}/events/${e}/edit`,{method:"POST",credentials:"include",body:t});if(s.ok){const t=Date.now();return"undefined"!=typeof window?(window.location.href=`/events/${e}?refresh=${t}`,null):p(`/events/${e}?refresh=${t}`)}{const e=await s.json();return u({errors:e},{status:400})}}default:return u({errors:{server:"Invalid form submission"}},{status:400})}}catch(a){return u({errors:{server:"Network error. Please try again"}},{status:500})}},Ge=new Map;function Me(e){if(e)for(const t of Ge.keys())t.includes(e)&&Ge.delete(t);else Ge.clear()}const Ve=async({request:e,params:t})=>{const r=await e.formData(),s=r.get("intent");try{switch(s){case"create-post":{const e=r.get("userId"),t=r.get("title"),s=r.get("caption"),a=r.get("image"),n={};if((!t||t.length<5||t.length>25)&&(n.title="Title must be between 5 and 25 characters"),(!s||s.length<50||s.length>500)&&(n.caption="Caption must be between 50 and 500 characters"),a&&0!==a.size||(n.image="Image is required"),e||(n.server="User ID is required"),Object.keys(n).length>0)return u({errors:n},{status:400});const o=new FormData;o.append("title",t),o.append("caption",s),o.append("image",a);const i=await fetch(`/api/users/${e}/posts/create`,{method:"POST",body:o});if(!i.ok){const e=await i.json();return u({errors:e},{status:400})}return Me("posts"),Me("profile"),p("/profile")}case"edit-post":{const e=r.get("postId")||t.postId,s=r.get("userId"),a=r.get("title"),n=r.get("caption"),o=r.get("image"),i={};if((!a||a.length<5||a.length>25)&&(i.title="Title must be between 5 and 25 characters"),(!n||n.length<50||n.length>500)&&(i.caption="Caption must be between 50 and 500 characters"),Object.keys(i).length>0)return u({errors:i},{status:400});const l=new FormData;l.append("title",a),l.append("caption",n),o&&o.size>0&&l.append("image",o);const c=await fetch(`/api/users/${s}/posts/${e}`,{method:"POST",body:l});if(!c.ok){const e=await c.json();return u({errors:e},{status:400})}return Me(`post-${e}`),Me("posts"),Me("profile"),window.location.href="/profile"}case"delete-post":{const e=r.get("postId")||t.postId;if(!e)return u({error:"Post ID is required"},{status:400});return(await fetch(`/api/posts/${e}/delete`,{method:"DELETE"})).ok?(Me(`post-${e}`),Me("posts"),Me("profile"),window.location.href="/profile"):u({error:"Failed to delete post"},{status:500})}case"like-post":{const e=r.get("postId")||t.postId;if(!e)return u({error:"Post ID is required"},{status:400});return(await fetch(`/api/posts/${e}/like`,{method:"POST",headers:{"Content-Type":"application/json"}})).ok?(Me(`post-${e}`),Me("posts"),u({success:!0})):u({error:"Failed to like post"},{status:500})}case"unlike-post":{const e=r.get("postId")||t.postId;if(!e)return u({error:"Post ID is required"},{status:400});return(await fetch(`/api/posts/${e}/unlike`,{method:"POST",headers:{"Content-Type":"application/json"}})).ok?(Me(`post-${e}`),Me("posts"),u({success:!0})):u({error:"Failed to unlike post"},{status:500})}default:return u({error:"Invalid action"},{status:400})}}catch(a){return u({error:"Network error. Please try again"},{status:500})}},We=new Map;function Be(e){const t=We.get(e);return t&&Date.now()-t.timestamp<6e4?t.data:(We.delete(e),null)}function He(e,t){We.set(e,{data:t,timestamp:Date.now()})}function Ye(e){if(e)for(const t of We.keys())t.includes(e)&&We.delete(t);else We.clear()}async function Je(e,t,r,s){const a=Be(s);if(a)return a;const n=await fetch(`/api/posts/${e}?page=${t}&per_page=${r}`,{headers:{"Cache-Control":"max-age=60"}});if(!n.ok){const e=await n.text();throw new Error(`HTTP ${n.status}: ${e}`)}const o=await n.json();return He(s,o),o}async function Ke(){const e=Be("feed-stats");if(e)return e;try{const e=await fetch("/api/posts/feed/stats",{headers:{"Cache-Control":"max-age=300"}});if(!e.ok)return{totalPosts:0,similarUsers:0,similarPosts:0,userTags:0};const t=await e.json();return He("feed-stats",t),t}catch(t){return{totalPosts:0,similarUsers:0,similarPosts:0,userTags:0}}}const Qe=e.lazy(()=>je(()=>import("./index-DjOjcrN4.js"),__vite__mapDeps([0,1,2,3,4]))),Xe=e.lazy(()=>je(()=>import("./index-G5dmKjYv.js"),__vite__mapDeps([5,1,2,3,4]))),Ze=e.lazy(()=>je(()=>import("./index-mhd6DGoQ.js"),__vite__mapDeps([6,1,3,2,4,7]))),et=e.lazy(()=>je(()=>import("./index-CExRMfjA.js"),__vite__mapDeps([8,1,3,2,4]))),tt=e.lazy(()=>je(()=>import("./index-fhNEmGQa.js"),__vite__mapDeps([9,1,3,2,4]))),rt=e.lazy(()=>je(()=>import("./index-CKiKcFr-.js"),__vite__mapDeps([10,1,3,2,4]))),st=e.lazy(()=>je(()=>import("./index-CLJoKBvc.js"),__vite__mapDeps([11,1,3,2,4]))),at=e.lazy(()=>je(()=>import("./index-o_uNkAwD.js"),__vite__mapDeps([12,1,3,2,4]))),nt=e.lazy(()=>je(()=>import("./index-UdDJUMOf.js"),__vite__mapDeps([13,1,3,2,4]))),ot=e.lazy(()=>je(()=>import("./index-SzCDafW0.js"),__vite__mapDeps([14,1,3,2,4]))),it=e.lazy(()=>je(()=>import("./index-CK2rDTn-.js"),__vite__mapDeps([15,1,3,2,4]))),lt=e.lazy(()=>je(()=>import("./index-CL4ah_Wt.js"),__vite__mapDeps([16,1,3,17,4,18,19,2,20]))),ct=e.lazy(()=>je(()=>import("./index-uHtsNH4_.js"),__vite__mapDeps([21,1,3,18,4,19,2]))),dt=e.lazy(()=>je(()=>import("./index-mbppx2q8.js"),__vite__mapDeps([22,1,3,4,2,23]))),ut=e.lazy(()=>je(()=>import("./index-BM2nLjNZ.js"),__vite__mapDeps([24,1,3,2,4]))),pt=e.lazy(()=>je(()=>import("./index-D-ZbUe9_.js"),__vite__mapDeps([25,1,3,2,4]))),ht=e.lazy(()=>je(()=>import("./PostDetails-CyuKWZH_.js"),__vite__mapDeps([26,1,3,2,18,4,17]))),mt=e.lazy(()=>je(()=>import("./PostsFeed-Cbv57-xG.js"),__vite__mapDeps([27,1,3,2,18,4,19]))),ft=e.lazy(()=>je(()=>import("./index-BPPQ49AL.js"),__vite__mapDeps([28,1,3,2,4]))),gt=e.lazy(()=>je(()=>import("./index-C0ik_dvc.js"),__vite__mapDeps([29,1,3,2,4]))),xt=e.lazy(()=>je(()=>import("./index-B_ajAAxY.js"),__vite__mapDeps([30,1,3,4,2]))),wt=e.lazy(()=>je(()=>import("./index-DyLq9hE5.js"),__vite__mapDeps([31,1,3,4,2]))),jt=e.lazy(()=>je(()=>import("./index-BGlf2pXn.js"),__vite__mapDeps([32,3,1,4,2]))),yt=e.lazy(()=>je(()=>import("./index-CGR7KcV_.js"),__vite__mapDeps([33,3,1,4,2]))),bt=h([{path:"/",element:Y.jsx($e,{}),errorElement:Y.jsx(ze,{}),children:[{index:!0,loader:async()=>{try{let t=null;try{const e=await fetch("/api/auth/",{headers:{"Cache-Control":"max-age=30"}});if(e.ok){const r=e.headers.get("content-type");if(r&&r.includes("application/json")){const r=await e.json();r.authenticated&&r.user&&!r.user.errors&&(t=r.user)}}}catch(e){}const r=["/api/groups","/api/events","/api/tags"].map(async t=>{try{const e=await fetch(t);return e.ok?await e.json():null}catch(e){return null}}),[s,a,n]=await Promise.all(r),o=(null==s?void 0:s.groups)||s||[],i=(null==a?void 0:a.events)||a||[];return u({allGroups:o,allEvents:i,allTags:n||[],user:t})}catch(e){return u({allGroups:[],allEvents:[],allTags:[],user:null,error:"Failed to load some data"})}},element:Y.jsx(Re,{children:Y.jsx(Ze,{})}),errorElement:Y.jsx(ze,{})},{path:"login",element:Y.jsx(Re,{children:Y.jsx(Qe,{})}),action:async({request:e})=>{const t=await e.formData(),r=t.get("email"),s=t.get("password"),a={};if((!r||r.length<4)&&(a.email="Email is required"),(!s||s.length<6)&&(a.password="Password must be at least 6 characters"),Object.keys(a).length>0)return u({errors:a},{status:400});try{const t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,password:s})});if(t.ok){const t=new URL(e.url).searchParams.get("from")||"/";return"undefined"!=typeof window&&(window.location.href=t),p(t)}if(t.status<500){const e=await t.json();return u({errors:e},{status:400})}return u({errors:{server:"Something went wrong. Please try again"}},{status:500})}catch(n){return u({errors:{server:"Network error. Please try again"}},{status:500})}},errorElement:Y.jsx(ze,{})},{path:"signup",element:Y.jsx(Re,{children:Y.jsx(Xe,{})}),action:async({request:e})=>{const t=await e.formData(),r=t.get("email"),s=t.get("username"),a=t.get("password"),n=t.get("confirmPassword"),o=t.get("firstName"),i=t.get("lastName"),l=t.get("bio"),c=t.get("profileImage"),d=t.getAll("userTags"),p={};a!==n&&(p.confirmPassword="Confirm Password field must be the same as the Password field");if(r.length>50&&(p.email="Email must be less than 50 characters"),(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)||r.length<=0)&&(p.email="Invalid email"),s.length>20&&(p.username="Username too long! Come on, who ya tryna confuse? Yourself?"),s.length<3&&(p.username="Username is too short! At least 3 characters man!"),s.length||(p.username="Now you know you need a username, I need 3 to 20 characters for you to signup!"),a.length>25&&(p.password="Password is too long!"),a.length<8&&(p.password="Password is too short!"),a.length<0&&(p.password="Password is required"),(!o.length||o.length<3||o.length>20)&&(p.firstName="First name must be between 3 and 20 characters"),(!i.length||i.length<3||i.length>20)&&(p.lastName="Last name must be between 3 and 20 characters"),(!l.length||l.length<50||l.length>500)&&(p.bio="Please enter at least 50 characters describing yourself"),c||(p.profileImage="Please add a profile image"),d.length||(p.userTags="Please select 1 or more tags that fit your description"),Object.keys(p).length>0)return u({errors:p},{status:400});try{const r=await fetch("/api/auth/signup",{method:"POST",body:t});if(r.ok){const t=await r.json(),s=new URL(e.url),a=s.searchParams.get("groupId"),n=s.searchParams.get("eventId");a&&await fetch(`/api/groups/${a}/join-group`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_id:a,user_id:t.id})}),n&&await fetch(`/api/events/${n}/attend-event`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:n,user_id:t.id})});const o=s.searchParams.get("from")||"/";return"undefined"!=typeof window&&(window.location.href=o),window.location.href=o}{const e=await r.json();return u({errors:e},{status:400})}}catch(h){return u({errors:{server:"Something went wrong. Please try again."}},{status:500})}},errorElement:Y.jsx(ze,{})},{path:"groups",loader:async({request:e})=>{try{const t=new URL(e.url).searchParams,r=t.get("page")||"1",s=t.get("per_page")||"20",a=Date.now(),n=await fetch(`/api/groups?page=${r}&per_page=${s}&_t=${a}`,{credentials:"include",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!n.ok)throw new Error(`Failed to fetch groups: ${n.status}`);const o=await n.json();let i;return i=o.groups?o:Array.isArray(o)?{groups:o}:{groups:o.groups||[]},{allGroups:i,currentPage:parseInt(r),perPage:parseInt(s)}}catch(t){return{allGroups:{groups:[]},currentPage:1,perPage:20,error:t instanceof Error?t.message:"Failed to load groups"}}},element:Y.jsx(Re,{children:Y.jsx(et,{})}),errorElement:Y.jsx(ze,{})},{path:"groups/:groupId",loader:async({params:e})=>{const{groupId:t}=e;if(!t)throw new Response("Group ID is required",{status:400});try{const e=Date.now(),r=await fetch(`/api/groups/${t}?_t=${e}`,{credentials:"include",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!r.ok){if(404===r.status)throw new Response("Group not found",{status:404});throw new Error(`Failed to fetch group: ${r.status}`)}const s=await r.json();if(s.members||(s.members=[]),s.organizer&&!s.members.some(e=>e.userId===s.organizerId)){const e={id:`organizer_${s.organizerId}`,userId:s.organizerId,groupId:s.id,isOrganizer:!0,user:{id:s.organizer.id,firstName:s.organizer.firstName,lastName:s.organizer.lastName,username:s.organizer.username,email:s.organizer.email,profileImage:s.organizer.profileImage}};s.members.unshift(e)}return s}catch(r){if(r instanceof Response)throw r;throw new Response("Failed to load group",{status:500})}},element:Y.jsx(Re,{children:Y.jsx(tt,{})}),action:async({request:e,params:t})=>{const r=await e.formData(),s=r.get("intent"),{groupId:a}=t||{},n=r.get("id"),o=a||n;if(!o)return u({error:"Group ID is required"},{status:400});try{switch(s){case"join-group":{const e=r.get("userId");if(!e)return u({error:"User ID is required"},{status:400});const t=await fetch(`/api/groups/${o}/join-group`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_id:parseInt(o),user_id:parseInt(e)})});if(t.ok)return window.location.href=`/groups/${o}`,null;{const e=await t.json();return u({error:e.message||"Failed to join group"},{status:500})}}case"leave-group":{const e=r.get("userId"),t=r.get("memberId");if(!e)return u({error:"User ID is required"},{status:400});const s=t||e,a=await fetch(`/api/groups/${o}/leave-group/${s}`,{method:"DELETE",credentials:"include"});if(a.ok)return p("/groups");{const e=await a.json();return u({error:e.message||"Failed to leave group"},{status:500})}}case"delete-group":{const e=await fetch(`/api/groups/${o}/delete`,{method:"DELETE",credentials:"include"});if(e.ok)return window.location.href="/groups",null;{const t=await e.json();return u({error:t.message||"Failed to delete group"},{status:500})}}default:return u({error:"Invalid action"},{status:400})}}catch(i){return u({error:"Network error. Please try again"},{status:500})}},errorElement:Y.jsx(ze,{})},{path:"events",loader:async({request:e})=>{try{const t=new URL(e.url).searchParams,r=t.get("page")||"1",s=t.get("per_page")||"20",a=Date.now(),n=await fetch(`/api/events?page=${r}&per_page=${s}&_t=${a}`,{credentials:"include",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!n.ok)throw new Error(`Failed to fetch events: ${n.status}`);const o=await n.json();let i;return i=o.events?o:Array.isArray(o)?{events:o}:{events:o.events||[]},{allEvents:i,currentPage:parseInt(r),perPage:parseInt(s)}}catch(t){return{allEvents:{events:[]},currentPage:1,perPage:20,error:t instanceof Error?t.message:"Failed to load events"}}},element:Y.jsx(Re,{children:Y.jsx(at,{})}),errorElement:Y.jsx(ze,{})},{path:"events/:eventId",loader:async({params:e})=>{const{eventId:t}=e;if(!t)throw new Error("Event ID is required");try{const e=Date.now(),r=await fetch(`/api/events/${t}?_t=${e}`,{credentials:"include",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!r.ok)throw new Error(`Failed to fetch event: ${r.status}`);return await r.json()}catch(r){throw r}},element:Y.jsx(Re,{children:Y.jsx(nt,{})}),action:async({request:e,params:t})=>{const r=await e.formData(),s=r.get("intent"),a=t.eventId||r.get("id");if(!a)return u({error:"Event ID is required"},{status:400});try{switch(s){case"attend-event":{const e=r.get("userId");if(!e)return u({error:"User ID is required"},{status:400});return(await fetch(`/api/events/${a}/attend-event`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:parseInt(a),user_id:parseInt(e)})})).ok?p(`/events/${a}`):u({error:"Failed to attend event"},{status:500})}case"leave-event":{const e=r.get("userId"),t=r.get("attendeeId");if(!e)return u({error:"User ID is required"},{status:400});const s=t||e;return(await fetch(`/api/events/${a}/leave-event/${s}`,{method:"DELETE"})).ok?p(`/events/${a}`):u({error:"Failed to leave event"},{status:500})}case"delete-event":return(await fetch(`/api/events/${a}`,{method:"DELETE"})).ok?p("/events"):u({error:"Failed to delete event"},{status:500});default:return u({error:"Invalid action"},{status:400})}}catch(n){return u({error:"Network error. Please try again"},{status:500})}},errorElement:Y.jsx(ze,{})},{path:"users/:userId",loader:async({params:e})=>{const{userId:t}=e;if(!t)throw new Response("User ID is required",{status:400});try{let e=null,s=!1;try{const r=await fetch("/api/auth/",{headers:{"Cache-Control":"max-age=30"}});if(r.ok){const a=await r.json();a.authenticated&&a.user&&(e=a.user,s=a.user.id.toString()===t)}}catch(r){}if(s)return p("/profile");const a=await fetch(`/api/users/${t}`,{headers:{"Cache-Control":"max-age=120"}});if(!a.ok){if(404===a.status)throw new Response("User not found",{status:404});throw new Response("Failed to load user profile",{status:500})}return{user:await a.json(),currentUser:e,isOwnProfile:!1,isAuthenticated:!!e}}catch(s){if(s instanceof Response)throw s;throw new Response("Failed to load user profile",{status:500})}},element:Y.jsx(Re,{children:Y.jsx(ct,{})}),errorElement:Y.jsx(ze,{})},{path:"profile",loader:async function({params:e}={}){const t="current-user-profile",r=function(e){const t=Ae.get(e);return t&&Date.now()-t.timestamp<3e5?t.data:(Ae.delete(e),null)}(t);if(r)return r;try{const r=await fetch("/api/auth/profile",{method:"GET",headers:{"Content-Type":"application/json","Cache-Control":"max-age=120"}});if(!r.ok){if(401===r.status)return p("/login");throw new Error(`HTTP error! status: ${r.status}`)}const n=await r.json();if(n.errors||!n.authenticated&&!n.id)return p("/login");const o=n.user||n;if((null==e?void 0:e.id)&&o.id.toString()!==e.id)return p("/profile");const i={user:o};return s=t,a=i,Ae.set(s,{data:a,timestamp:Date.now()}),i}catch(n){return p("/login")}var s,a},element:Y.jsx(Re,{children:Y.jsx(De,{children:Y.jsx(lt,{})})}),action:async({request:e})=>{const t=await e.formData(),r=t.get("intent");if("add-tags"===r){const e=t.get("userId");if(!e)return u({error:"User ID is required"},{status:400});const r=t.getAll("userTags");if(0===r.length)return u({error:"Please select at least one tag"},{status:400});try{const t={userTags:r,userId:parseInt(e)},s=await fetch(`/api/users/${e}/add-tags`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(s.ok)return qe("profile"),qe("user"),p("/profile");{const e=await s.json();return u({error:e.message||"Failed to add tags"},{status:500})}}catch(s){return u({error:"Network error. Please try again"},{status:500})}}if("delete-profile"===r){const e=t.get("userId");if(!e)return u({error:"User ID is required"},{status:400});try{const r=await fetch(`/api/users/${e}/profile/delete`,{method:"DELETE",body:t});if(r.ok)return await fetch("/api/auth/logout",{method:"GET"}),qe(),"undefined"!=typeof window&&(window.location.href="/"),null;{const e=await r.json();return u({error:e.message||"Failed to delete profile"},{status:500})}}catch(s){return u({error:"Network error. Please try again"},{status:500})}}return u({error:"Invalid form submission"},{status:400})},errorElement:Y.jsx(ze,{})},{path:"posts-feed",loader:async({request:e}={})=>{try{await async function(){const e=await fetch("/api/auth/",{headers:{"Cache-Control":"max-age=30"}});if(!e.ok)throw p("/login");const t=await e.json();if(!t.authenticated||!t.user)throw p("/login");return!0}();const r=e?new URL(e.url):new URL(window.location.href),s=parseInt(r.searchParams.get("page")||"1"),a=Math.min(parseInt(r.searchParams.get("per_page")||"20"),50),n=r.searchParams.get("tab")||"all";try{const e=await async function(e,t){const r=`batch-feed-${e}-${t}`,s=Be(r);if(s)return s;const a=await fetch(`/api/posts/feed/batch?page=${e}&per_page=${t}`,{headers:{"Cache-Control":"max-age=60"}});if(!a.ok){const e=await a.text();throw new Error(`HTTP ${a.status}: ${e}`)}const n=await a.json(),o={allPosts:n.allPosts||[],similarPosts:n.similarPosts||[],allPostsPagination:n.allPostsPagination||{page:1,pages:0,per_page:t,total:0,has_next:!1,has_prev:!1},similarPostsPagination:n.similarPostsPagination||{page:1,pages:0,per_page:t,total:0,has_next:!1,has_prev:!1},stats:n.stats||{totalPosts:0,similarUsers:0,similarPosts:0,userTags:0},activeTab:n.activeTab||"all",message:n.message};return He(r,o),o}(s,a);return e.activeTab=n,e}catch(t){const[e,r,o]=await Promise.allSettled([Je("feed/all",s,a,`all-posts-${s}-${a}`),Je("feed/similar",s,a,`similar-posts-${s}-${a}`),Ke()]);let i=[],l={page:1,pages:0,per_page:a,total:0,has_next:!1,has_prev:!1};"fulfilled"===e.status&&(i=e.value.posts||[],l=e.value.pagination||l);let c,d=[],u={page:1,pages:0,per_page:a,total:0,has_next:!1,has_prev:!1};"fulfilled"===r.status?(d=r.value.posts||[],u=r.value.pagination||u,c=r.value.message):c="Failed to load posts from similar users";let p={totalPosts:0,similarUsers:0,similarPosts:0,userTags:0};return"fulfilled"===o.status&&(p=o.value),{allPosts:i,similarPosts:d,allPostsPagination:l,similarPostsPagination:u,stats:p,activeTab:n,message:c}}}catch(r){if(r instanceof Response)throw r;return{allPosts:[],similarPosts:[],allPostsPagination:{page:1,pages:0,per_page:20,total:0,has_next:!1,has_prev:!1},similarPostsPagination:{page:1,pages:0,per_page:20,total:0,has_next:!1,has_prev:!1},stats:{totalPosts:0,similarUsers:0,similarPosts:0,userTags:0},activeTab:"all",error:r instanceof Error?r.message:"Failed to load posts feed"}}},element:Y.jsx(Re,{children:Y.jsx(De,{children:Y.jsx(mt,{})})}),action:async({request:e})=>{const t=await e.formData(),r=t.get("intent");try{switch(r){case"like-post":{const e=t.get("postId");if(!e)return u({error:"Post ID is required"},{status:400});const r=await fetch(`/api/posts/${e}/like`,{method:"POST",headers:{"Content-Type":"application/json"}});if(r.ok)return Ye("posts"),Ye("stats"),Ye("batch"),u({success:!0});{const e=await r.json();return u({error:e.message||"Failed to like post"},{status:r.status})}}case"unlike-post":{const e=t.get("postId");if(!e)return u({error:"Post ID is required"},{status:400});const r=await fetch(`/api/posts/${e}/unlike`,{method:"POST",headers:{"Content-Type":"application/json"}});if(r.ok)return Ye("posts"),Ye("stats"),Ye("batch"),u({success:!0});{const e=await r.json();return u({error:e.message||"Failed to unlike post"},{status:r.status})}}case"refresh-feed":return Ye(),u({success:!0,message:"Feed refreshed"});default:return u({error:"Invalid action"},{status:400})}}catch(s){return u({error:"Network error. Please try again"},{status:500})}}},{path:"similar-feed",loader:async({request:e}={})=>{var t;try{const r=await fetch("/api/auth/");if(!r.ok)return p("/login");if((await r.json()).errors)return p("/login");const s=e?new URL(e.url):new URL(window.location.href),a=parseInt(s.searchParams.get("page")||"1"),n=parseInt(s.searchParams.get("per_page")||"20"),o=await fetch(`/api/posts/similar-feed?page=${a}&per_page=${n}`);if(!o.ok){await o.text();throw new Error(`HTTP ${o.status}`)}const i=await o.json(),l={},c={};i.posts&&Array.isArray(i.posts)&&i.posts.forEach(e=>{if(e.user){const t=e.user.id;c[t]||(c[t]={id:e.user.id,username:e.user.username,firstName:e.user.firstName||"",lastName:e.user.lastName||"",email:"",bio:"",profileImage:e.user.profileImage,usersTags:[],createdAt:"",updatedAt:""}),l[t]||(l[t]=[]),l[t].push(e)}});return{users_profile:Object.keys(c).map(e=>{const t=parseInt(e);return{...c[t],posts:l[t]||[]}}),pagination:i.pagination,totalPosts:(null==(t=i.posts)?void 0:t.length)||0,message:i.message}}catch(r){return{users_profile:[],pagination:{page:1,pages:0,per_page:20,total:0,has_next:!1,has_prev:!1},totalPosts:0,error:`Failed to load posts: ${r instanceof Error?r.message:"Unknown error"}`}}},element:Y.jsx(Re,{children:Y.jsx(De,{children:Y.jsx(pt,{})})}),action:Ve},{path:"profile-feed",loader:async({request:e}={})=>{try{const t=await fetch("/api/auth/",{method:"GET",headers:{"Content-Type":"application/json","Cache-Control":"max-age=30"}});if(!t.ok)return p("/login");if((await t.json()).errors)return p("/login");const r=e?new URL(e.url):new URL(window.location.href),s=parseInt(r.searchParams.get("page")||"1"),a=`/api/users/profile-feed?page=${s}&per_page=${Math.min(parseInt(r.searchParams.get("per_page")||"20"),50)}`,n=await fetch(a,{method:"GET",headers:{"Content-Type":"application/json","Cache-Control":"max-age=60"}});if(!n.ok)throw new Error("Failed to fetch profile feed");const o=await n.json();return o.users_profile?o:Array.isArray(o)?{users_profile:o}:{users_profile:[]}}catch(t){return{users_profile:[]}}},element:Y.jsx(Re,{children:Y.jsx(De,{children:Y.jsx(ut,{})})}),action:Ve},{path:"groups/new",loader:Le,element:Y.jsx(Re,{children:Y.jsx(De,{children:Y.jsx(rt,{})})}),action:Fe},{path:"groups/:groupId/edit",loader:async({params:e})=>{const{groupId:t}=e;if(!t)throw new Response("Group ID is required",{status:400});try{const e=await fetch("/api/auth/",{headers:{"Cache-Control":"max-age=30"}});if(!e.ok)return p("/login");const r=await e.json();if(!r.authenticated||!r.user)return p("/login");const s=Date.now(),a=await fetch(`/api/groups/${t}?_t=${s}`,{credentials:"include",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!a.ok){if(404===a.status)throw new Response("Group not found",{status:404});throw new Error(`Failed to fetch group: ${a.status}`)}const n=await a.json();if(r.user.id!==n.organizerId)throw new Response("Unauthorized - You must be the group organizer",{status:403});return{...n,user:r.user}}catch(r){if(r instanceof Response)throw r;throw new Response("Failed to load group",{status:500})}},element:Y.jsx(Re,{children:Y.jsx(De,{children:Y.jsx(st,{})})}),action:Fe},{path:"groups/:groupId/events/new",loader:async({params:e})=>{const{groupId:t}=e;if(!t)throw new Response("Group ID is required",{status:400});try{const e=await fetch("/api/auth/",{headers:{"Cache-Control":"max-age=30"}});if(!e.ok)return p("/login");const r=await e.json();if(!r.authenticated||!r.user)return p("/login");const s=Date.now(),a=await fetch(`/api/groups/${t}?_t=${s}`,{credentials:"include",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!a.ok){if(404===a.status)throw new Response("Group not found",{status:404});throw new Error(`Failed to fetch group: ${a.status}`)}const n=await a.json();if(r.user.id!==n.organizerId)throw new Response("Unauthorized - You must be the group organizer",{status:403});return{...n,user:r.user}}catch(r){if(r instanceof Response)throw r;throw new Response("Failed to load group",{status:500})}},element:Y.jsx(Re,{children:Y.jsx(De,{children:Y.jsx(ot,{})})}),action:Ue},{path:"groups/:groupId/events/:eventId/edit",loader:async({params:e})=>{const{groupId:t,eventId:r}=e;if(!t||!r)throw new Response("Group ID and Event ID are required",{status:400});try{const e=await fetch("/api/auth/",{headers:{"Cache-Control":"max-age=30"}});if(!e.ok)return p("/login");const s=await e.json();if(!s.authenticated||!s.user)return p("/login");const a=Date.now(),[n,o]=await Promise.all([fetch(`/api/events/${r}?_t=${a}`,{credentials:"include",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}}),fetch(`/api/groups/${t}?_t=${a}`,{credentials:"include",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}})]);if(!n.ok)return 404===n.status?p("/events?error=event-not-found"):p(`/events/${r}?error=fetch-failed`);if(!o.ok)return 404===o.status?p("/groups?error=group-not-found"):p(`/groups/${t}?error=fetch-failed`);const[i,l]=await Promise.all([n.json(),o.json()]);return s.user.id!==l.organizerId?p(`/events/${r}?error=unauthorized`):{event:i,group:l,user:s.user}}catch(s){if(s instanceof Response)throw s;return s instanceof TypeError&&s.message.includes("fetch")?p(`/events/${r}?error=network`):p(`/events/${r}?error=unknown`)}},element:Y.jsx(Re,{children:Y.jsx(De,{children:Y.jsx(it,{})})}),action:Ue,errorElement:Y.jsx(ze,{})},{path:"users/:userId/profile/update",loader:Le,element:Y.jsx(Re,{children:Y.jsx(De,{children:Y.jsx(dt,{})})}),action:async({request:e,params:t})=>{const r=await e.formData(),s=r.get("intent");if("delete-profile"===s){const e=r.get("userId");if(!e)return u({error:"User ID is required"},{status:400});try{const t=await fetch(`/api/users/${e}/profile/delete`,{method:"DELETE",body:r});if(t.ok)return await fetch("/api/auth/logout",{method:"GET"}),qe(),"undefined"!=typeof window&&(window.location.href="/"),null;{const e=await t.json();return u({error:e.message||"Failed to delete profile"},{status:500})}}catch(f){return u({error:"Network error. Please try again"},{status:500})}}if("update-profile"!==s)return u({error:"Invalid form submission"},{status:400});const a=t.id||r.get("userId");if(!a)return u({errors:{server:"User ID is required"}},{status:400});const n={},o=r.get("firstName"),i=r.get("lastName"),l=r.get("username"),c=r.get("email"),d=r.get("password"),h=r.get("confirmPassword"),m=r.get("bio");(!o||o.length<3||o.length>20)&&(n.firstName="First name must be between 3 and 20 characters"),(!i||i.length<3||i.length>20)&&(n.lastName="Last name must be between 3 and 20 characters");c&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c)?c.length>50&&(n.email="Email must be less than 50 characters"):n.email="Please enter a valid email address",(!l||l.length<3||l.length>20)&&(n.username="Username must be between 3 and 20 characters"),d&&(d.length<8||d.length>25)&&(n.password="Password must be between 8 and 25 characters"),d!==h&&(n.confirmPassword="Passwords do not match"),(!m||m.length<50||m.length>500)&&(n.bio="Bio must be between 50 and 500 characters");if(0===r.getAll("userTags").length&&(n.userTags="Please select at least one tag"),Object.keys(n).length>0)return u({errors:n},{status:400});try{const e=await fetch(`/api/users/${a}/profile/update`,{method:"POST",body:r});if(e.ok)return qe("profile"),qe("user"),p("/profile");if(e.status<500){const t=await e.json();return u({errors:t},{status:400})}return u({errors:{server:"Something went wrong. Please try again"}},{status:500})}catch(f){return u({errors:{server:"Network error. Please try again"}},{status:500})}}},{path:"posts/:postId",loader:async({params:e})=>{const{postId:t}=e;if(!t)throw new Error("Post ID is required");try{const e=await fetch(`/api/posts/${t}`,{method:"GET",headers:{"Content-Type":"application/json","Cache-Control":"max-age=120"}});if(!e.ok)throw new Error("Failed to fetch post details");return await e.json()}catch(r){return p("/similar-feed")}},element:Y.jsx(Re,{children:Y.jsx(ht,{})}),action:Ve},{path:"posts/create",loader:Le,element:Y.jsx(Re,{children:Y.jsx(De,{children:Y.jsx(ft,{})})}),action:Ve},{path:"posts/:postId/edit",loader:Le,element:Y.jsx(Re,{children:Y.jsx(De,{children:Y.jsx(gt,{})})}),action:Ve},{path:"partnership",element:Y.jsx(Re,{children:Y.jsx(xt,{})}),action:async({request:e})=>{const t=await e.formData(),r={};if("create-partnership"===t.get("intent")){const e=t.get("firstName"),a=t.get("lastName"),n=t.get("phone"),o=t.get("email"),i=t.get("subject"),l=t.get("message"),c=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if((!e||e.length<3||e.length>20)&&(r.firstName="First name must be between 3 and 20 characters"),(!a||a.length<3||a.length>20)&&(r.lastName="Last name must be between 3 and 20 characters"),!o||o.length<=0||!c.test(o)?r.email="Invalid email":o.length>50&&(r.email="Email must be less than 50 characters"),n&&isNaN(Number(n))&&(r.phone="Invalid phone number"),(!i||i.length<3||i.length>20)&&(r.subject="Subject must be between 3 and 20 characters"),(!l||l.length<10||l.length>500)&&(r.message="Please enter at least 10 characters describing yourself"),Object.keys(r).length)return u(r);try{const e=await fetch("/api/partnerships/",{method:"POST",body:t});if(!e.ok){const t=await e.json();return t.email?u({email:"Email already in use"}):u({backendError:t.message||"Something went wrong"})}return p("/success")}catch(s){return u({backendError:"Network error occurred"})}}return u({backendError:"Invalid intent"})}},{path:"contact",element:Y.jsx(Re,{children:Y.jsx(wt,{})}),action:async({request:e})=>{const t=await e.formData(),r={};if("create-contact"===t.get("intent")){const e=t.get("firstName"),a=t.get("lastName"),n=t.get("phone"),o=t.get("email"),i=t.get("subject"),l=t.get("message"),c=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if((!e||e.length<3||e.length>20)&&(r.firstName="First name must be between 3 and 20 characters"),(!a||a.length<3||a.length>20)&&(r.lastName="Last name must be between 3 and 20 characters"),!o||o.length<=0||!c.test(o)?r.email="Invalid email":o.length>50&&(r.email="Email must be less than 50 characters"),n&&isNaN(Number(n))&&(r.phone="Invalid phone number"),(!i||i.length<3||i.length>20)&&(r.subject="Subject must be between 3 and 20 characters"),(!l||l.length<10||l.length>500)&&(r.message="Please enter at least 10 characters describing yourself"),Object.keys(r).length)return u(r);try{const e=await fetch("/api/contact/",{method:"POST",body:t});if(e.ok)return p("/success");{const t=await e.json();return u({backendError:t.message||"Something went wrong"})}}catch(s){return u({backendError:"Network error occurred"})}}return u({backendError:"Invalid intent"})}},{path:"success",element:Y.jsx(Re,{children:Y.jsx(jt,{})})}]},{path:"*",element:Y.jsx($e,{children:Y.jsx(Re,{children:Y.jsx(yt,{})})}),errorElement:Y.jsx(ze,{})}]),vt=oe(ge,Nt,xe);var Nt;J.createRoot(document.getElementById("root")).render(Y.jsx(r.StrictMode,{children:Y.jsx(n,{store:vt,children:Y.jsx(m,{router:bt,fallbackElement:Y.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 via-white to-slate-50 flex items-center justify-center",children:Y.jsxs("div",{className:"text-center",children:[Y.jsx("div",{className:"w-12 h-12 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),Y.jsx("p",{className:"text-slate-600",children:"Loading..."})]})})})})}));export{Ee as L,Ne as O,Y as j,me as t,ve as u};
