import{j as e}from"./index-D_QOT4VP.js";import{r as s}from"./react-vendor-DWDxyCYt.js";import{e as t,u as a,f as l,g as r,L as o}from"./router-vendor-DFbjbkyO.js";import{a as i}from"./redux-vendor-s9F9CGgp.js";import{V as n,a7 as d,w as c,U as m,c as x,T as h,v as g,y as u,z as b,a1 as j,q as p,r as f,a3 as v,t as N,e as w,a2 as y,Q as k}from"./ui-vendor-CiRjMc1E.js";const z=({size:s=24,className:t="",color:a="currentColor"})=>e.jsx("svg",{width:s,height:s,viewBox:"0 0 24 24",fill:a,className:t,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z",fill:a})}),C=()=>{var N,w,y,k,z,C;const $=t(),L=i(e=>e.session.user),T=a(),[S,M]=l(),A=r(),[U,F]=s.useState("grid"),[I,D]=s.useState(""),[R,Y]=s.useState([]),[q,B]=s.useState(new Set),[E,Q]=s.useState(!1),V=S.get("tab")||$.activeTab||"all",G=parseInt(S.get("page")||"1"),{activePosts:H,activePagination:J}=s.useMemo(()=>"similar"===V?{activePosts:$.similarPosts||[],activePagination:$.similarPostsPagination}:{activePosts:$.allPosts||[],activePagination:$.allPostsPagination},[V,$]),K=s.useMemo(()=>I||0!==R.length?H.filter(e=>!I||(e.title.toLowerCase().includes(I.toLowerCase())||e.caption.toLowerCase().includes(I.toLowerCase())||e.user.username.toLowerCase().includes(I.toLowerCase()))):H,[H,I,R]),O=s.useCallback(e=>{const s=new Date,t=new Date(e),a=Math.floor((s.getTime()-t.getTime())/1e3);if(a<60)return"just now";const l=Math.floor(a/60);if(l<60)return`${l}m ago`;const r=Math.floor(l/60);if(r<24)return`${r}h ago`;const o=Math.floor(r/24);if(o<7)return`${o}d ago`;const i=Math.floor(o/7);if(i<4)return`${i}w ago`;const n=Math.floor(o/30);if(n<12)return`${n}mo ago`;return`${Math.floor(o/365)}y ago`},[]),W=s.useCallback(e=>{const s=new URLSearchParams(S);s.set("tab",e),s.delete("page"),M(s)},[S,M]),X=s.useCallback(e=>{const s=new URLSearchParams(S);s.set("page",e.toString()),M(s),window.scrollTo({top:0,behavior:"smooth"})},[S,M]),Z=s.useCallback(()=>{Q(!0),A.submit({intent:"refresh-feed"},{method:"post"}),setTimeout(()=>{Q(!1)},1e3)},[A]),_=s.useCallback(async(e,s)=>{L?(B(t=>{const a=new Set(t);return s?a.delete(e):a.add(e),a}),A.submit({intent:s?"unlike-post":"like-post",postId:e.toString()},{method:"post"})):T("/login")},[L,T,A]),ee=s.useCallback(()=>{D(""),Y([])},[]);return $.error?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-orange-50 to-slate-100 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-sm border border-red-200 max-w-md mx-auto text-center",children:[e.jsx(n,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-red-800 mb-2",children:"Error Loading Posts"}),e.jsx("p",{className:"text-red-600 mb-4",children:$.error}),e.jsxs("button",{onClick:Z,className:"inline-flex items-center gap-2 bg-orange-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-orange-600 transition-colors",disabled:E,children:[e.jsx(d,{size:18,className:E?"animate-spin":""}),"Try Again"]})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-orange-50 to-slate-100",children:[e.jsx("div",{className:"bg-white/80 backdrop-blur-sm border-b border-slate-200 sticky top-0 z-40",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("h1",{className:"text-xl font-bold text-slate-800",children:"Posts Feed"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[L&&e.jsxs(o,{to:"/posts/create",className:"inline-flex items-center gap-2 bg-gradient-to-r from-orange-500 to-slate-600 text-white px-4 py-2 rounded-lg font-medium hover:from-orange-600 hover:to-slate-700 transition-all duration-200 shadow-md hover:shadow-lg",children:[e.jsx(c,{size:18}),"Create Post"]}),e.jsx("button",{onClick:Z,className:"p-2 rounded-lg text-slate-600 hover:text-slate-900 hover:bg-slate-100 transition-colors "+(E?"animate-spin":""),disabled:E,children:e.jsx(d,{size:20})})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-orange-600 to-slate-800 bg-clip-text text-transparent mb-4",children:"Community Posts"}),e.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Discover posts from the community and connect with users who share your interests."})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-1 mb-8 flex",children:[e.jsxs("button",{onClick:()=>W("all"),className:"flex-1 py-3 px-4 rounded-lg font-medium transition-colors "+("all"===V?"bg-orange-100 text-orange-700":"text-slate-600 hover:text-slate-900 hover:bg-slate-50"),children:["All Posts (",(null==(N=$.stats)?void 0:N.totalPosts)||0,")"]}),e.jsxs("button",{onClick:()=>W("similar"),className:"flex-1 py-3 px-4 rounded-lg font-medium transition-colors "+("similar"===V?"bg-orange-100 text-orange-700":"text-slate-600 hover:text-slate-900 hover:bg-slate-50"),children:["Similar Users (",(null==(w=$.stats)?void 0:w.similarPosts)||0,")"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(m,{size:24,className:"text-orange-600"})}),e.jsx("h3",{className:"text-2xl font-bold text-slate-900",children:"all"===V?(null==(y=$.stats)?void 0:y.totalPosts)||0:(null==(k=$.stats)?void 0:k.similarUsers)||0}),e.jsx("p",{className:"text-slate-600",children:"all"===V?"Total Posts":"Similar Users"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(x,{size:24,className:"text-blue-600"})}),e.jsx("h3",{className:"text-2xl font-bold text-slate-900",children:"all"===V?"All":(null==(z=$.stats)?void 0:z.similarPosts)||0}),e.jsx("p",{className:"text-slate-600",children:"all"===V?"Community":"Similar Posts"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(h,{size:24,className:"text-purple-600"})}),e.jsx("h3",{className:"text-2xl font-bold text-slate-900",children:(null==(C=$.stats)?void 0:C.userTags)||0}),e.jsx("p",{className:"text-slate-600",children:"Your Tags"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(g,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search posts by title, content, or username...",value:I,onChange:e=>D(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors"})]})}),e.jsxs("div",{className:"flex items-center gap-1 bg-slate-100 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>F("grid"),className:"p-2 rounded-md transition-colors "+("grid"===U?"bg-white shadow-sm text-orange-600":"text-slate-600 hover:text-slate-900"),children:e.jsx(u,{size:18})}),e.jsx("button",{onClick:()=>F("list"),className:"p-2 rounded-md transition-colors "+("list"===U?"bg-white shadow-sm text-orange-600":"text-slate-600 hover:text-slate-900"),children:e.jsx(b,{size:18})})]}),(I||R.length>0)&&e.jsx("button",{onClick:ee,className:"px-4 py-2 text-orange-600 hover:text-orange-700 font-medium transition-colors",children:"Clear Filters"})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:e.jsxs("p",{className:"text-sm text-slate-600",children:["Showing"," ",e.jsx("span",{className:"font-semibold",children:K.length})," ","posts",I&&` matching "${I}"`,"similar"===V&&" from similar users"]})})]}),0===K.length?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-24 h-24 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(j,{size:32,className:"text-slate-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"No posts found"}),e.jsx("p",{className:"text-slate-600 mb-6 max-w-md mx-auto",children:I?"Try adjusting your search terms to find more posts.":"similar"===V&&$.message?$.message:"No posts are currently available. Check back later!"}),L&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(o,{to:"/posts/create",className:"inline-flex items-center gap-2 bg-gradient-to-r from-orange-500 to-slate-600 text-white px-6 py-3 rounded-lg font-medium hover:from-orange-600 hover:to-slate-700 transition-all duration-200",children:[e.jsx(c,{size:20}),"Create First Post"]}),"similar"===V&&(!L.usersTags||0===L.usersTags.length)&&e.jsx("div",{className:"mt-4",children:e.jsxs(o,{to:`/users/${L.id}/profile/update`,className:"inline-flex items-center gap-2 bg-blue-500 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-600 transition-colors",children:[e.jsx(m,{size:20}),"Add Tags to Your Profile"]})})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid"===U?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-6",children:K.map(s=>e.jsx(P,{post:s,viewMode:U,formatTimeAgo:O,handleLikePost:_,isLiked:q.has(s.id),sessionUser:L},s.id))}),J.pages>1&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>X(1),disabled:1===G,className:"px-3 py-1 rounded-md border border-slate-300 text-slate-700 hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"First"}),e.jsx("button",{onClick:()=>X(G-1),disabled:1===G,className:"p-1 rounded-md border border-slate-300 text-slate-700 hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(p,{size:18})}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,J.pages)},(s,t)=>{let a;return a=J.pages<=5||G<=3?t+1:G>=J.pages-2?J.pages-4+t:G-2+t,e.jsx("button",{onClick:()=>X(a),className:"w-8 h-8 flex items-center justify-center rounded-md "+(G===a?"bg-orange-500 text-white":"border border-slate-300 text-slate-700 hover:bg-slate-50"),children:a},a)})}),e.jsx("button",{onClick:()=>X(G+1),disabled:G===J.pages,className:"p-1 rounded-md border border-slate-300 text-slate-700 hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(f,{size:18})}),e.jsx("button",{onClick:()=>X(J.pages),disabled:G===J.pages,className:"px-3 py-1 rounded-md border border-slate-300 text-slate-700 hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Last"})]})})]}),"similar"===V&&$.message&&0===K.length&&e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mt-8 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-orange-600 mb-2",children:[e.jsx(v,{size:20}),e.jsx("h3",{className:"font-semibold",children:"Personalized Feed"})]}),e.jsx("p",{className:"text-orange-700",children:$.message}),e.jsxs(o,{to:`/users/${null==L?void 0:L.id}/profile/update`,className:"inline-flex items-center gap-2 bg-orange-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-orange-600 transition-colors mt-4",children:[e.jsx(m,{size:18}),"Add Tags to Profile"]})]})]})]})},P=({post:s,viewMode:t,formatTimeAgo:a,handleLikePost:l,isLiked:r})=>e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden hover:shadow-lg transition-all duration-300 "+("list"===t?"p-6":""),children:"grid"===t?e.jsxs("div",{children:[e.jsx("div",{className:"relative",children:e.jsx("img",{src:s.image,alt:s.title,className:"w-full h-64 object-cover",loading:"lazy"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(o,{to:`/users/${s.user.id}`,className:"flex-shrink-0",children:e.jsx("img",{src:s.user.profileImage,alt:s.user.username,className:"w-10 h-10 rounded-full object-cover border-2 border-slate-200",loading:"lazy"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx(o,{to:`/users/${s.user.id}`,className:"font-semibold text-slate-900 hover:text-orange-600 transition-colors block truncate",children:s.user.username}),e.jsxs("div",{className:"flex items-center text-xs text-slate-500",children:[e.jsx(N,{size:12,className:"mr-1"}),e.jsx("span",{children:a(s.createdAt)})]})]})]}),e.jsxs(o,{to:`/posts/${s.id}`,className:"block group",children:[e.jsx("h3",{className:"font-bold text-lg text-slate-900 group-hover:text-orange-600 transition-colors mb-2 line-clamp-2",children:s.title}),e.jsx("p",{className:"text-slate-600 text-sm line-clamp-3 mb-4",children:s.caption})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>l(s.id,r),className:"flex items-center gap-1 transition-colors "+(r?"text-red-500":"text-slate-500 hover:text-red-500"),children:[r?e.jsx(z,{size:18}):e.jsx(w,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:s.likes+(r?1:0)})]}),e.jsxs(o,{to:`/posts/${s.id}`,className:"flex items-center gap-1 text-slate-500 hover:text-blue-500 transition-colors",children:[e.jsx(j,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:s.comments})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"text-slate-400 hover:text-orange-500 transition-colors",children:e.jsx(y,{size:18})}),e.jsx("button",{className:"text-slate-400 hover:text-green-500 transition-colors",children:e.jsx(k,{size:18})})]})]})]})]}):e.jsxs("div",{className:"flex gap-6",children:[e.jsx(o,{to:`/posts/${s.id}`,className:"flex-shrink-0 w-32 h-32 sm:w-48 sm:h-48 overflow-hidden rounded-lg",children:e.jsx("img",{src:s.image,alt:s.title,className:"w-full h-full object-cover hover:scale-105 transition-transform duration-300",loading:"lazy"})}),e.jsxs("div",{className:"flex-1 min-w-0 flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(o,{to:`/users/${s.user.id}`,className:"flex-shrink-0",children:e.jsx("img",{src:s.user.profileImage,alt:s.user.username,className:"w-8 h-8 rounded-full object-cover border-2 border-slate-200",loading:"lazy"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx(o,{to:`/users/${s.user.id}`,className:"font-semibold text-slate-900 hover:text-orange-600 transition-colors block truncate",children:s.user.username}),e.jsxs("div",{className:"flex items-center text-xs text-slate-500",children:[e.jsx(N,{size:12,className:"mr-1"}),e.jsx("span",{children:a(s.createdAt)})]})]})]}),e.jsxs(o,{to:`/posts/${s.id}`,className:"block group flex-1",children:[e.jsx("h3",{className:"font-bold text-lg text-slate-900 group-hover:text-orange-600 transition-colors mb-2",children:s.title}),e.jsx("p",{className:"text-slate-600 text-sm line-clamp-2 mb-4",children:s.caption})]}),e.jsxs("div",{className:"flex items-center justify-between mt-auto",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>l(s.id,r),className:"flex items-center gap-1 transition-colors "+(r?"text-red-500":"text-slate-500 hover:text-red-500"),children:[r?e.jsx(z,{size:16}):e.jsx(w,{size:16}),e.jsx("span",{className:"text-sm font-medium",children:s.likes+(r?1:0)})]}),e.jsxs(o,{to:`/posts/${s.id}`,className:"flex items-center gap-1 text-slate-500 hover:text-blue-500 transition-colors",children:[e.jsx(j,{size:16}),e.jsx("span",{className:"text-sm font-medium",children:s.comments})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"text-slate-400 hover:text-orange-500 transition-colors",children:e.jsx(y,{size:16})}),e.jsx("button",{className:"text-slate-400 hover:text-green-500 transition-colors",children:e.jsx(k,{size:16})})]})]})]})]})});export{C as default};
